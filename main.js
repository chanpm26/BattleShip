(()=>{"use strict";function e(e,t){for(let n=0;n<e.gameBoard.board.length;n++){let a=document.createElement("div");a.classList.add("gameSquare"),a.classList.add(e.playerName),a.setAttribute("data-id",n),t.appendChild(a)}}function t(){location.reload()}function n(e){document.getElementById("message").textContent=e}const a=()=>{let e=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],t=[],n=[],a=0;return{board:e,sunkShips:a,successfulAttacks:n,missedAttacks:t,placeShip:function(t,n,a){let i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const i=e=>(e=parseInt(e),!!n.includes(e)&&(a.push(e),!0)),r=function(e){return t==a.length?(e=!0,this.sunkStatus=e,e):(e=!1,this.sunkStatus=e,e)};return{nameOfShip:e,length:t,coordinates:n,whereHit:a,sunkStatus:arguments.length>4&&void 0!==arguments[4]&&arguments[4],hit:i,isSunk:r}}(t,n,a);a.forEach((t=>{e[t].push(i)}))},receiveAttack:function(i){if(""!=e[i]){n.push(i);let t=e[i][0].hit(i),r=e[i][0].isSunk();return 1==r&&(a+=1),{attackStatus:t,shipStatus:r}}return t.push(i),!1},report:function(){return e.map((e=>{if(""!=e)return e[0].isSunk(),1==e[0].sunkStatus})).includes(!1)?"There are still alive ships":"All ships have sunk!"}}},i=function(e,t){return{playerName:e,sendAttack:function(e,t){let n="valid";return(e.missedAttacks.includes(t)||null!=e.successfulAttacks&&e.successfulAttacks.includes(t))&&(n="notValid"),"valid"==n?e.receiveAttack(t):"notvalid"},gameBoard:a()}};function r(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const o=Array.from(document.getElementsByClassName("draggable"));let c="";function s(e){e.preventDefault()}function d(e){e.target.style.backgroundColor="aqua"}function l(e){e.target.style.backgroundColor=null}function u(e){e.dataTransfer.setData("text",e.target.getAttribute("id")),c=e.target.id}function m(e){e.preventDefault();let t=e.dataTransfer.getData("text"),n=e.target;l(e),n.appendChild(document.querySelector(`[id="${t}"]`))}function h(){let e=Array.from(document.getElementsByClassName("droppable")).filter((e=>{if(e.hasChildNodes())return e}));return{boxID:e.map((e=>e.getAttribute("set-id"))),shipID:e.map((e=>e.firstChild.id))}}function p(){Array.from(document.getElementsByClassName("droppable")).forEach((e=>{e.addEventListener("drop",(function(){5==h().boxID.length&&document.getElementById("beginButton").classList.remove("hidden")}))}))}function g(e,t){return t=Number(t),"carrier"==e?[t,t+1,t+2,t+3,t+4]:"battleship"==e?[t,t+1,t+2,t+3]:"cruiser"==e||"submarine"==e?[t,t+1,t+2]:"destroyer"==e?[t,t+1]:void 0}let f=i("playerOne"),v="",E="";beginButton.addEventListener("click",(function(){let e=h(),t=function(e,t){return{shipOne:g(t[0],e[0]),shipTwo:g(t[1],e[1]),shipThree:g(t[2],e[2]),shipFour:g(t[3],e[3]),shipFive:g(t[4],e[4])}}(e.boxID,e.shipID);f.gameBoard.placeShip("carrier",t.shipOne.length,t.shipOne),f.gameBoard.placeShip("battleship",t.shipTwo.length,t.shipTwo),f.gameBoard.placeShip("submarine",t.shipThree.length,t.shipThree),f.gameBoard.placeShip("cruiser",t.shipFour.length,t.shipFour),f.gameBoard.placeShip("destroyer",t.shipFive.length,t.shipFive)}));let S=function(){let e=r(0,2).toString()+r(0,5).toString();e=Number(e);let t=[e,e+1,e+2,e+3,e+4],n=r(3,4).toString()+r(0,6).toString();n=Number(n);let a=[n,n+1,n+2,n+3],i=r(7,8).toString()+r(0,7).toString();i=Number(i);let o=[i,i+1,i+2],c="9"+r(0,7).toString();c=Number(c);let s=[c,c+1,c+2],d=r(5,6).toString()+r(0,7).toString();return d=Number(d),{firstShipCoordinates:t,secondShipCoordinates:a,thirdShipCoordinates:o,fourthShipCoordinates:s,fifthShipCoordinates:[d,d+1]}}(),y=i("playerTwo");function B(e,t,n){e==f?(t.style.pointerEvents="none",n.style.pointerEvents="auto"):e==y&&(n.style.pointerEvents="none",t.style.pointerEvents="auto")}function L(e,t,a,i){let r=e.sendAttack(t.gameBoard,i);return"notvalid"==r?(e==f&&n("That move is not valid. Please pick another tile."),"notvalid"):(1==r.attackStatus?(a.style.backgroundColor="green",n("")):0==r&&(a.style.backgroundColor="red",n("")),1==r.shipStatus&&n("A ship becomes feast for the fishes!"),v=function(e){return"All ships have sunk!"==e.gameBoard.report()}(t),r)}function b(e,n,a){if(B(e,n,a),Array.from(document.getElementsByClassName("gameSquare")).forEach((i=>{i.addEventListener("click",(function(){let r=i.getAttribute("data-id");e==f&&("notvalid"!=L(e,y,i,r)&&(B(e=y,n,a),b(e,n,a)),1==v&&function(e){document.getElementById("mainContainer").classList.add("hidden");const n=document.getElementById("gameOverContainer");n.classList.remove("hidden");let a=document.createElement("h1");a.innerText=`The game is over. ${e} has won!`,n.appendChild(a);const i=document.createElement("button");i.textContent="Start New Game",i.classList.add("newgame"),i.onclick=t,n.appendChild(i)}(e==f?"Computer":playerOneName.textContent))}))})),e==y)if(""!=E){let t=E+1,i=document.querySelector(`[data-id="${t}"]`);setTimeout((()=>{let o=L(e,f,i,t);for(;"notvalid"==o;){let t=r(0,99),n=document.querySelector(`[data-id="${t}"]`);o=L(e,f,n,t)}"notvalid"!=o&&(B(e=f,n,a),E=1==o.attackStatus&&0==o.shipStatus?t:"")}),700)}else{let t=r(0,99),i=document.querySelector(`[data-id="${t}"]`);setTimeout((()=>{let o=L(e,f,i,t);for(;"notvalid"==o;){let t=r(0,99),n=document.querySelector(`[data-id="${t}"]`);o=L(e,f,n,t)}"notvalid"!=o&&(B(e=f,n,a),E=1==o.attackStatus&&0==o.shipStatus?t:"")}),700)}}y.gameBoard.placeShip("carrier",5,S.firstShipCoordinates),y.gameBoard.placeShip("battleship",4,S.secondShipCoordinates),y.gameBoard.placeShip("submarine",3,S.thirdShipCoordinates),y.gameBoard.placeShip("cruiser",3,S.fourthShipCoordinates),y.gameBoard.placeShip("destroyer",2,S.fifthShipCoordinates);const C=document.getElementById("boardOne"),k=document.getElementById("boardTwo"),A=document.getElementById("prepareButton"),I=document.getElementById("beginButton"),N=document.getElementById("playerOneName"),T=document.getElementById("newGameButton");let w=document.getElementById("playerName"),x=f,q="";w.addEventListener("input",(function(){q=w.value})),A.addEventListener("click",(function(){document.getElementById("welcomeScreenContainer").classList.add("hidden"),document.getElementById("selectScreenContainer").classList.remove("hidden"),function(){const e=document.getElementById("selectBoard");for(let t=0;t<100;t++){let n=document.createElement("div");n.classList.add("selectSquare"),n.classList.add("droppable"),n.setAttribute("set-id",t),e.appendChild(n)}}(),o.forEach((e=>{e.addEventListener("dragstart",u)}));const e=Array.from(document.getElementsByClassName("droppable"));e.forEach((t=>{t.addEventListener("dragover",(function(){!function(e){"carrier"==c?e.slice(0,6).concat(e.slice(10,16)).concat(e.slice(20,26)).concat(e.slice(30,36)).concat(e.slice(40,46)).concat(e.slice(50,56)).concat(e.slice(60,66)).concat(e.slice(70,76)).concat(e.slice(80,86)).concat(e.slice(90,96)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"battleship"==c?e.slice(0,7).concat(e.slice(10,17)).concat(e.slice(20,27)).concat(e.slice(30,37)).concat(e.slice(40,47)).concat(e.slice(50,57)).concat(e.slice(60,67)).concat(e.slice(70,77)).concat(e.slice(80,87)).concat(e.slice(90,97)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"cruiser"==c||"submarine"==c?e.slice(0,8).concat(e.slice(10,18)).concat(e.slice(20,28)).concat(e.slice(30,38)).concat(e.slice(40,48)).concat(e.slice(50,58)).concat(e.slice(60,68)).concat(e.slice(70,78)).concat(e.slice(80,88)).concat(e.slice(90,98)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"destroyer"==c&&e.slice(0,9).concat(e.slice(10,19)).concat(e.slice(20,29)).concat(e.slice(30,39)).concat(e.slice(40,49)).concat(e.slice(50,59)).concat(e.slice(60,69)).concat(e.slice(70,79)).concat(e.slice(80,89)).concat(e.slice(90,99)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)}))}(e)}))}))})),I.addEventListener("click",(function(){document.getElementById("selectScreenContainer").classList.add("hidden"),document.getElementById("mainContainer").classList.remove("hidden"),function(e,t){e.textContent=""!=t?t:"Anonymous Challenger"}(N,q),e(f,C),e(y,k)})),I.addEventListener("click",(function(){b(x,C,k)})),T.onclick=t})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L2RvbS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3RvcnlGdW5jdGlvbnMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9jb21wdXRlcmNvb3JkaW5hdGVzLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZHJhZ2FuZGRyb3AuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lbG9naWMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzaG93U2VsZWN0aW9uU2NyZWVuKCkge1xuICBjb25zdCB3ZWxjb21lU2NyZWVuQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgXCJ3ZWxjb21lU2NyZWVuQ29udGFpbmVyXCJcbiAgKTtcbiAgd2VsY29tZVNjcmVlbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICBjb25zdCBzZWxlY3RTY3JlZW5Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICBcInNlbGVjdFNjcmVlbkNvbnRhaW5lclwiXG4gICk7XG4gIHNlbGVjdFNjcmVlbkNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xufVxuXG5mdW5jdGlvbiBzaG93U2VsZWN0Qm9hcmQoKSB7XG4gIGNvbnN0IHNlbGVjdEJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWxlY3RCb2FyZFwiKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xuICAgIGxldCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RTcXVhcmUnKTtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInNldC1pZFwiLCBpKTtcbiAgICBzZWxlY3RCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNob3dHYW1lQm9hcmQoKSB7XG4gIGNvbnN0IHNlbGVjdFNjcmVlbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgIFwic2VsZWN0U2NyZWVuQ29udGFpbmVyXCJcbiAgKTtcbiAgc2VsZWN0U2NyZWVuQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIGNvbnN0IG1haW5Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW5Db250YWluZXJcIik7XG4gIG1haW5Db250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlR2FtZUJvYXJkKHBsYXllciwgYm9hcmQpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5ZXIuZ2FtZUJvYXJkLmJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGdhbWVTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGdhbWVTcXVhcmUuY2xhc3NMaXN0LmFkZChcImdhbWVTcXVhcmVcIik7XG4gICAgZ2FtZVNxdWFyZS5jbGFzc0xpc3QuYWRkKHBsYXllci5wbGF5ZXJOYW1lKTtcbiAgICBnYW1lU3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgaSk7XG4gICAgYm9hcmQuYXBwZW5kQ2hpbGQoZ2FtZVNxdWFyZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYWRkUGxheWVyTmFtZShwbGF5ZXIsIHBsYXllck5hbWUpIHtcbiAgaWYgKHBsYXllck5hbWUgIT0gXCJcIikge1xuICAgIHBsYXllci50ZXh0Q29udGVudCA9IHBsYXllck5hbWU7XG4gIH0gZWxzZSB7XG4gICAgcGxheWVyLnRleHRDb250ZW50ID0gXCJBbm9ueW1vdXMgQ2hhbGxlbmdlclwiO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5ld0dhbWUoKSB7XG4gIGxvY2F0aW9uLnJlbG9hZCgpO1xufVxuXG5mdW5jdGlvbiBzaG93R2FtZU92ZXIoY3VycmVudFBsYXllcikge1xuICBjb25zdCBtYWluQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluQ29udGFpbmVyXCIpO1xuICBtYWluQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIGNvbnN0IGdhbWVPdmVyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lT3ZlckNvbnRhaW5lclwiKTtcbiAgZ2FtZU92ZXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJylcbiAgbGV0IGRpc3BsYXlXaW5uZXJUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICBkaXNwbGF5V2lubmVyVGV4dC5pbm5lclRleHQgPSBgVGhlIGdhbWUgaXMgb3Zlci4gJHtjdXJyZW50UGxheWVyfSBoYXMgd29uIWA7XG4gIGdhbWVPdmVyQ29udGFpbmVyLmFwcGVuZENoaWxkKGRpc3BsYXlXaW5uZXJUZXh0KTtcbiAgY29uc3QgbmV3R2FtZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gIG5ld0dhbWVCdXR0b24udGV4dENvbnRlbnQgPSBcIlN0YXJ0IE5ldyBHYW1lXCI7XG4gIG5ld0dhbWVCdXR0b24uY2xhc3NMaXN0LmFkZChcIm5ld2dhbWVcIik7XG4gIG5ld0dhbWVCdXR0b24ub25jbGljayA9IG5ld0dhbWU7XG4gIGdhbWVPdmVyQ29udGFpbmVyLmFwcGVuZENoaWxkKG5ld0dhbWVCdXR0b24pO1xufVxuXG5mdW5jdGlvbiBzaG93TWVzc2FnZShtZXNzYWdlKSB7XG4gIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lc3NhZ2VcIik7XG4gIG1lc3NhZ2VDb250YWluZXIudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xufVxuXG5leHBvcnQge1xuICBjcmVhdGVHYW1lQm9hcmQsXG4gIHNob3dTZWxlY3Rpb25TY3JlZW4sXG4gIHNob3dTZWxlY3RCb2FyZCxcbiAgc2hvd0dhbWVCb2FyZCxcbiAgYWRkUGxheWVyTmFtZSxcbiAgbmV3R2FtZSxcbiAgc2hvd0dhbWVPdmVyLFxuICBzaG93TWVzc2FnZSxcbn07XG4iLCJjb25zdCBzaGlwRmFjdG9yeSA9IChcbiAgbmFtZU9mU2hpcCxcbiAgbGVuZ3RoLFxuICBjb29yZGluYXRlcyA9IFtdLFxuICB3aGVyZUhpdCA9IFtdLFxuICBzdW5rU3RhdHVzID0gZmFsc2VcbikgPT4ge1xuICBjb25zdCBoaXQgPSAobnVtYmVyKSA9PiB7XG4gICAgbnVtYmVyID0gcGFyc2VJbnQobnVtYmVyKVxuICAgaWYgKGNvb3JkaW5hdGVzLmluY2x1ZGVzKG51bWJlcikpIHtcbiAgICAgICAgd2hlcmVIaXQucHVzaChudW1iZXIpO1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfTtcbiAgY29uc3QgaXNTdW5rID0gZnVuY3Rpb24gKHN1bmtTdGF0dXMpIHtcbiAgICBpZiAobGVuZ3RoID09IHdoZXJlSGl0Lmxlbmd0aCkge1xuICAgICAgc3Vua1N0YXR1cyA9IHRydWU7XG4gICAgICB0aGlzLnN1bmtTdGF0dXMgPSBzdW5rU3RhdHVzXG4gICAgICByZXR1cm4gc3Vua1N0YXR1cztcbiAgICB9IGVsc2Uge1xuICAgIHN1bmtTdGF0dXMgPSBmYWxzZTtcbiAgICB0aGlzLnN1bmtTdGF0dXMgPSBzdW5rU3RhdHVzXG4gICAgcmV0dXJuIHN1bmtTdGF0dXM7XG4gIH19O1xuICByZXR1cm4geyBuYW1lT2ZTaGlwLCBsZW5ndGgsIGNvb3JkaW5hdGVzLCB3aGVyZUhpdCwgc3Vua1N0YXR1cywgaGl0LCBpc1N1bmsgfTtcbn07XG5cblxuLy9nYW1lQm9hcmQgaXMgMTB4MTBcblxuY29uc3QgZ2FtZUJvYXJkRmFjdG9yeSA9ICgpID0+IHtcbiAgbGV0IGJvYXJkID0gW1xuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLFxuICAgIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdXG4gIF1cbiAgbGV0IG1pc3NlZEF0dGFja3MgPSBbXVxuICBsZXQgc3VjY2Vzc2Z1bEF0dGFja3MgPSBbXVxuICBsZXQgc3Vua1NoaXBzID0gMFxuICBjb25zdCBwbGFjZVNoaXAgPSBmdW5jdGlvbiAobmFtZU9mU2hpcCwgbGVuZ3RoLCBjb29yZGluYXRlcykge1xuICAgIGxldCBuZXdTaGlwID0gc2hpcEZhY3RvcnkobmFtZU9mU2hpcCwgbGVuZ3RoLCBjb29yZGluYXRlcyk7XG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZGluYXRlID0+IHtcbiAgICAgIGJvYXJkW2Nvb3JkaW5hdGVdLnB1c2gobmV3U2hpcClcbiAgICB9KVxuICAgIH1cbiAgO1xuICBjb25zdCByZWNlaXZlQXR0YWNrID0gZnVuY3Rpb24obnVtYmVyKSB7XG4gICAgaWYgKGJvYXJkW251bWJlcl0gIT0gXCJcIikge1xuICAgICAgc3VjY2Vzc2Z1bEF0dGFja3MucHVzaChudW1iZXIpO1xuICAgICAgbGV0IGF0dGFja1N0YXR1cyA9IGJvYXJkW251bWJlcl1bMF0uaGl0KG51bWJlcik7XG4gICAgICBsZXQgc2hpcFN0YXR1cyA9IGJvYXJkW251bWJlcl1bMF0uaXNTdW5rKClcbiAgICAgIGlmIChzaGlwU3RhdHVzID09IHRydWUpIHtcbiAgICAgICAgc3Vua1NoaXBzICs9IDFcbiAgICAgIH1cbiAgICAgIHJldHVybiB7YXR0YWNrU3RhdHVzLCBzaGlwU3RhdHVzfVxuICAgIH0gZWxzZSB7ICAgICAgXG4gICAgICBtaXNzZWRBdHRhY2tzLnB1c2gobnVtYmVyKTtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gXG4gIH07XG4gIGNvbnN0IHJlcG9ydCA9IGZ1bmN0aW9uKCkge1xuICAgIGxldCBjaGVja1N0YXR1cyA9IGJvYXJkLm1hcCgodGlsZSkgPT4ge1xuICAgICAgaWYgKHRpbGUgIT0gJycpIHtcbiAgICAgICAgdGlsZVswXS5pc1N1bmsoKVxuICAgICAgaWYgKHRpbGVbMF0uc3Vua1N0YXR1cyA9PSB0cnVlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gICAgaWYgKGNoZWNrU3RhdHVzLmluY2x1ZGVzKGZhbHNlKSkge1xuICAgICAgcmV0dXJuIFwiVGhlcmUgYXJlIHN0aWxsIGFsaXZlIHNoaXBzXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcIkFsbCBzaGlwcyBoYXZlIHN1bmshXCI7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7IGJvYXJkLCBzdW5rU2hpcHMsIHN1Y2Nlc3NmdWxBdHRhY2tzLCBtaXNzZWRBdHRhY2tzLCBwbGFjZVNoaXAsIHJlY2VpdmVBdHRhY2ssIHJlcG9ydCB9O1xufTtcblxuLy9wbGF5ZXIgRmFjdG9yeVxuXG5cbmNvbnN0IHBsYXllckZhY3RvcnkgPSBmdW5jdGlvbihwbGF5ZXJOYW1lLCBwbGF5ZXJUeXBlKSB7XG4gIGNvbnN0IGdhbWVCb2FyZCA9IGdhbWVCb2FyZEZhY3RvcnkoKTsgICBcbiAgICBjb25zdCBzZW5kQXR0YWNrID0gZnVuY3Rpb24oYm9hcmQsIGNvb3JkaW5hdGUpIHtcbiAgICAgIGxldCBhdHRhY2tTdGF0dXMgPSAndmFsaWQnXG4gICAgICBpZiAoYm9hcmQubWlzc2VkQXR0YWNrcy5pbmNsdWRlcyhjb29yZGluYXRlKSkge1xuICAgICAgICAgIGF0dGFja1N0YXR1cyA9ICdub3RWYWxpZCdcbiAgICAgICAgfSBlbHNlIGlmIChib2FyZC5zdWNjZXNzZnVsQXR0YWNrcyAhPSB1bmRlZmluZWQgJiYgYm9hcmQuc3VjY2Vzc2Z1bEF0dGFja3MuaW5jbHVkZXMoY29vcmRpbmF0ZSkpIHtcbiAgICAgICAgICBhdHRhY2tTdGF0dXMgPSAnbm90VmFsaWQnXG4gICAgICAgfVxuICAgICAgIGlmIChhdHRhY2tTdGF0dXMgPT0gJ3ZhbGlkJykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gYm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlKVxuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdub3R2YWxpZCdcbiAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7cGxheWVyTmFtZSwgc2VuZEF0dGFjaywgZ2FtZUJvYXJkfVxufVxuXG5leHBvcnQgeyBnYW1lQm9hcmRGYWN0b3J5LCBwbGF5ZXJGYWN0b3J5LCBzaGlwRmFjdG9yeSB9O1xuIiwiZnVuY3Rpb24gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMobWluLCBtYXgpIHtcbiAgbWluID0gTWF0aC5jZWlsKG1pbik7XG4gIG1heCA9IE1hdGguZmxvb3IobWF4KTtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29tcHV0ZXJDb29yZGluYXRlcygpIHtcbiAgbGV0IGZpcnN0U2hpcEZpcnN0TnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgMikudG9TdHJpbmcoKTtcbiAgbGV0IGZpcnN0U2hpcFNlY29uZE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDAsIDUpLnRvU3RyaW5nKCk7XG4gIGxldCBmaXJzdFNoaXBGaXJzdFBvc2l0aW9uID0gZmlyc3RTaGlwRmlyc3ROdW1iZXIgKyBmaXJzdFNoaXBTZWNvbmROdW1iZXI7XG4gIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gPSBOdW1iZXIoZmlyc3RTaGlwRmlyc3RQb3NpdGlvbik7XG4gIGxldCBmaXJzdFNoaXBDb29yZGluYXRlcyA9IFtcbiAgICBmaXJzdFNoaXBGaXJzdFBvc2l0aW9uLFxuICAgIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gKyAxLFxuICAgIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gKyAyLFxuICAgIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gKyAzLFxuICAgIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gKyA0LFxuICBdO1xuICBsZXQgc2Vjb25kU2hpcEZpcnN0TnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMywgNCkudG9TdHJpbmcoKTtcbiAgbGV0IHNlY29uZFNoaXBTZWNvbmROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCA2KS50b1N0cmluZygpO1xuICBsZXQgc2Vjb25kU2hpcEZpcnN0UG9zaXRpb24gPSBzZWNvbmRTaGlwRmlyc3ROdW1iZXIgKyBzZWNvbmRTaGlwU2Vjb25kTnVtYmVyO1xuICBzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbiA9IE51bWJlcihzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbik7XG4gIGxldCBzZWNvbmRTaGlwQ29vcmRpbmF0ZXMgPSBbXG4gICAgc2Vjb25kU2hpcEZpcnN0UG9zaXRpb24sXG4gICAgc2Vjb25kU2hpcEZpcnN0UG9zaXRpb24gKyAxLFxuICAgIHNlY29uZFNoaXBGaXJzdFBvc2l0aW9uICsgMixcbiAgICBzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbiArIDMsXG4gIF07XG4gIGxldCB0aGlyZFNoaXBGaXJzdE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDcsIDgpLnRvU3RyaW5nKCk7XG4gIGxldCB0aGlyZFNoaXBTZWNvbmROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCA3KS50b1N0cmluZygpO1xuICBsZXQgdGhpcmRTaGlwRmlyc3RQb3NpdGlvbiA9IHRoaXJkU2hpcEZpcnN0TnVtYmVyICsgdGhpcmRTaGlwU2Vjb25kTnVtYmVyO1xuICB0aGlyZFNoaXBGaXJzdFBvc2l0aW9uID0gTnVtYmVyKHRoaXJkU2hpcEZpcnN0UG9zaXRpb24pO1xuICBsZXQgdGhpcmRTaGlwQ29vcmRpbmF0ZXMgPSBbXG4gICAgdGhpcmRTaGlwRmlyc3RQb3NpdGlvbixcbiAgICB0aGlyZFNoaXBGaXJzdFBvc2l0aW9uICsgMSxcbiAgICB0aGlyZFNoaXBGaXJzdFBvc2l0aW9uICsgMixcbiAgXTtcbiAgbGV0IGZvdXJ0aFNoaXBGaXJzdE51bWJlciA9IFwiOVwiXG4gIGxldCBmb3VydGhTaGlwU2Vjb25kTnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgNykudG9TdHJpbmcoKTtcbiAgbGV0IGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uID0gZm91cnRoU2hpcEZpcnN0TnVtYmVyICsgZm91cnRoU2hpcFNlY29uZE51bWJlcjtcbiAgZm91cnRoU2hpcEZpcnN0UG9zaXRpb24gPSBOdW1iZXIoZm91cnRoU2hpcEZpcnN0UG9zaXRpb24pO1xuICBsZXQgZm91cnRoU2hpcENvb3JkaW5hdGVzID0gW1xuICAgIGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uLFxuICAgIGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uICsgMSxcbiAgICBmb3VydGhTaGlwRmlyc3RQb3NpdGlvbiArIDIsXG4gIF07XG4gIGxldCBmaWZ0aFNoaXBGaXJzdE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDUsIDYpLnRvU3RyaW5nKCk7XG4gIGxldCBmaWZ0aFNoaXBTZWNvbmROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCA3KS50b1N0cmluZygpO1xuICBsZXQgZmlmdGhTaGlwRmlyc3RQb3NpdGlvbiA9IGZpZnRoU2hpcEZpcnN0TnVtYmVyICsgZmlmdGhTaGlwU2Vjb25kTnVtYmVyO1xuICBmaWZ0aFNoaXBGaXJzdFBvc2l0aW9uID0gTnVtYmVyKGZpZnRoU2hpcEZpcnN0UG9zaXRpb24pO1xuICBsZXQgZmlmdGhTaGlwQ29vcmRpbmF0ZXMgPSBbZmlmdGhTaGlwRmlyc3RQb3NpdGlvbiwgZmlmdGhTaGlwRmlyc3RQb3NpdGlvbiArIDFdO1xuICByZXR1cm4ge2ZpcnN0U2hpcENvb3JkaW5hdGVzLCBzZWNvbmRTaGlwQ29vcmRpbmF0ZXMsIHRoaXJkU2hpcENvb3JkaW5hdGVzLCBmb3VydGhTaGlwQ29vcmRpbmF0ZXMsIGZpZnRoU2hpcENvb3JkaW5hdGVzfVxufVxuXG5leHBvcnQge2dldFJhbmRvbUNvb3JkaW5hdGVzLCBjcmVhdGVDb21wdXRlckNvb3JkaW5hdGVzfVxuIiwiY29uc3QgZHJhZ2dhYmxlU2hpcHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkcmFnZ2FibGVcIikpO1xubGV0IGN1cnJlbnRTaGlwID0gXCJcIjtcblxuZnVuY3Rpb24gYWN0aXZhdGVEcm9wKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59XG5cbmZ1bmN0aW9uIHNob3dIb3ZlckNvbG9yKGV2ZW50KSB7XG4gIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImFxdWFcIjtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlSG92ZXJDb2xvcihldmVudCkge1xuICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gbnVsbDtcbn1cblxuZnVuY3Rpb24gZHJhZyhlKSB7XG4gIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJ0ZXh0XCIsIGUudGFyZ2V0LmdldEF0dHJpYnV0ZShcImlkXCIpKTtcbiAgY3VycmVudFNoaXAgPSBlLnRhcmdldC5pZDtcbn1cblxuZnVuY3Rpb24gZ2V0Q3VycmVudFNoaXAoY3VycmVudFNoaXApIHtcbiAgICByZXR1cm4gY3VycmVudFNoaXBcbn1cblxuZnVuY3Rpb24gZHJvcChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgbGV0IGRhdGEgPSBlLmRhdGFUcmFuc2Zlci5nZXREYXRhKFwidGV4dFwiKTtcbiAgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xuICByZW1vdmVIb3ZlckNvbG9yKGUpO1xuICB0YXJnZXQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2lkPVwiJHtkYXRhfVwiXWApKTtcbn1cblxubGV0IGFsbG93RHJhZyA9IGZ1bmN0aW9uICgpIHtcbiAgZHJhZ2dhYmxlU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIHNoaXAuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCBkcmFnKTtcbiAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIGdldFBvc2l0aW9ucygpIHtcbiAgY29uc3Qgc2VsZWN0Qm94ZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkcm9wcGFibGVcIikpO1xuICBsZXQgYm94ZXNXaXRoU2hpcHMgPSBzZWxlY3RCb3hlcy5maWx0ZXIoKGJveCkgPT4ge1xuICAgIGlmIChib3guaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICByZXR1cm4gYm94O1xuICAgIH1cbiAgfSk7XG4gIGxldCBib3hJRCA9IGJveGVzV2l0aFNoaXBzLm1hcCgoYm94KSA9PiBib3guZ2V0QXR0cmlidXRlKFwic2V0LWlkXCIpKTtcbiAgbGV0IHNoaXBJRCA9IGJveGVzV2l0aFNoaXBzLm1hcCgoYm94KSA9PiBib3guZmlyc3RDaGlsZC5pZCk7XG4gIHJldHVybiB7IGJveElELCBzaGlwSUQgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tQb3NpdGlvbnMoKSB7XG4gIGNvbnN0IHNlbGVjdEJveGVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZHJvcHBhYmxlXCIpKTtcbiAgc2VsZWN0Qm94ZXMuZm9yRWFjaCgoYm94KSA9PiB7XG4gICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjaGVjayA9IGdldFBvc2l0aW9ucygpO1xuICAgICAgaWYgKGNoZWNrLmJveElELmxlbmd0aCA9PSA1KSB7XG4gICAgICAgIGNvbnN0IGJlZ2luQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZWdpbkJ1dHRvblwiKTtcbiAgICAgICAgYmVnaW5CdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmxldCBhbGxvd0Ryb3AgPSBmdW5jdGlvbihzZWxlY3RCb3hlcykge1xuICAgIGlmIChjdXJyZW50U2hpcCA9PSBcImNhcnJpZXJcIikge1xuICAgICAgbGV0IGFsbG93YWJsZUJveGVzID0gc2VsZWN0Qm94ZXNcbiAgICAgICAgLnNsaWNlKDAsIDYpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMTAsIDE2KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgyMCwgMjYpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDMwLCAzNikpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNDAsIDQ2KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg1MCwgNTYpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDYwLCA2NikpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNzAsIDc2KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg4MCwgODYpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDkwLCA5NikpXG4gICAgICAgIGFsbG93YWJsZUJveGVzLmZvckVhY2goKGJveCkgPT4ge1xuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgYWN0aXZhdGVEcm9wKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIHNob3dIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCByZW1vdmVIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZHJvcCk7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBjaGVja1Bvc2l0aW9ucylcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChjdXJyZW50U2hpcCA9PSAnYmF0dGxlc2hpcCcpIHtcbiAgICAgIGxldCBhbGxvd2FibGVCb3hlcyA9IHNlbGVjdEJveGVzXG4gICAgICAgIC5zbGljZSgwLCA3KVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDEwLCAxNykpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMjAsIDI3KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgzMCwgMzcpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDQwLCA0NykpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNTAsIDU3KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg2MCwgNjcpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDcwLCA3NykpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoODAsIDg3KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg5MCwgOTcpKVxuICAgICAgICBhbGxvd2FibGVCb3hlcy5mb3JFYWNoKChib3gpID0+IHtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIGFjdGl2YXRlRHJvcCk7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCBzaG93SG92ZXJDb2xvcik7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgcmVtb3ZlSG92ZXJDb2xvcik7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGRyb3ApO1xuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgY2hlY2tQb3NpdGlvbnMpXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoY3VycmVudFNoaXAgPT0gJ2NydWlzZXInIHx8IGN1cnJlbnRTaGlwID09ICdzdWJtYXJpbmUnICkge1xuICAgICAgbGV0IGFsbG93YWJsZUJveGVzID0gc2VsZWN0Qm94ZXNcbiAgICAgICAgLnNsaWNlKDAsIDgpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMTAsIDE4KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgyMCwgMjgpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDMwLCAzOCkpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNDAsIDQ4KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg1MCwgNTgpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDYwLCA2OCkpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNzAsIDc4KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg4MCwgODgpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDkwLCA5OCkpXG4gICAgICAgIGFsbG93YWJsZUJveGVzLmZvckVhY2goKGJveCkgPT4ge1xuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgYWN0aXZhdGVEcm9wKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIHNob3dIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCByZW1vdmVIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZHJvcCk7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBjaGVja1Bvc2l0aW9ucylcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChjdXJyZW50U2hpcCA9PSAnZGVzdHJveWVyJykge1xuICAgICAgbGV0IGFsbG93YWJsZUJveGVzID0gc2VsZWN0Qm94ZXNcbiAgICAgICAgLnNsaWNlKDAsIDkpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMTAsIDE5KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgyMCwgMjkpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDMwLCAzOSkpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNDAsIDQ5KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg1MCwgNTkpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDYwLCA2OSkpXG4gICAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNzAsIDc5KSlcbiAgICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg4MCwgODkpKVxuICAgICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDkwLCA5OSkpXG4gICAgICAgIGFsbG93YWJsZUJveGVzLmZvckVhY2goKGJveCkgPT4ge1xuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgYWN0aXZhdGVEcm9wKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIHNob3dIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCByZW1vdmVIb3ZlckNvbG9yKTtcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZHJvcCk7XG4gICAgICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBjaGVja1Bvc2l0aW9ucylcbiAgICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG5mdW5jdGlvbiBjcmVhdGVTaGlwQ29vcmRpbmF0ZXMoc2hpcCwgYm94KSB7XG4gIGJveCA9IE51bWJlcihib3gpO1xuICBpZiAoc2hpcCA9PSBcImNhcnJpZXJcIikge1xuICAgIGxldCBjb29yZGluYXRlcyA9IFtib3gsIGJveCArIDEsIGJveCArIDIsIGJveCArIDMsIGJveCArIDRdO1xuICAgIHJldHVybiBjb29yZGluYXRlcztcbiAgfVxuICBpZiAoc2hpcCA9PSBcImJhdHRsZXNoaXBcIikge1xuICAgIGxldCBjb29yZGluYXRlcyA9IFtib3gsIGJveCArIDEsIGJveCArIDIsIGJveCArIDNdO1xuICAgIHJldHVybiBjb29yZGluYXRlcztcbiAgfVxuICBpZiAoc2hpcCA9PSBcImNydWlzZXJcIiB8fCBzaGlwID09IFwic3VibWFyaW5lXCIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbYm94LCBib3ggKyAxLCBib3ggKyAyXTtcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XG4gIH1cbiAgaWYgKHNoaXAgPT0gXCJkZXN0cm95ZXJcIikge1xuICAgIGxldCBjb29yZGluYXRlcyA9IFtib3gsIGJveCArIDFdO1xuICAgIHJldHVybiBjb29yZGluYXRlcztcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTaGlwcyhib3hlcywgc2hpcHMpIHtcbiAgbGV0IHNoaXBPbmUgPSBjcmVhdGVTaGlwQ29vcmRpbmF0ZXMoc2hpcHNbMF0sIGJveGVzWzBdKTtcbiAgbGV0IHNoaXBUd28gPSBjcmVhdGVTaGlwQ29vcmRpbmF0ZXMoc2hpcHNbMV0sIGJveGVzWzFdKTtcbiAgbGV0IHNoaXBUaHJlZSA9IGNyZWF0ZVNoaXBDb29yZGluYXRlcyhzaGlwc1syXSwgYm94ZXNbMl0pO1xuICBsZXQgc2hpcEZvdXIgPSBjcmVhdGVTaGlwQ29vcmRpbmF0ZXMoc2hpcHNbM10sIGJveGVzWzNdKTtcbiAgbGV0IHNoaXBGaXZlID0gY3JlYXRlU2hpcENvb3JkaW5hdGVzKHNoaXBzWzRdLCBib3hlc1s0XSk7XG4gIHJldHVybiB7IHNoaXBPbmUsIHNoaXBUd28sIHNoaXBUaHJlZSwgc2hpcEZvdXIsIHNoaXBGaXZlIH07XG59XG5cbmV4cG9ydCB7IGFsbG93RHJhZywgYWxsb3dEcm9wLCBnZXRQb3NpdGlvbnMsIGdldEN1cnJlbnRTaGlwLCBjdXJyZW50U2hpcCwgY2hlY2tQb3NpdGlvbnMsIGNyZWF0ZVNoaXBzIH07XG4iLCJpbXBvcnQgeyBwbGF5ZXJGYWN0b3J5IH0gZnJvbSBcIi4vZmFjdG9yeUZ1bmN0aW9uc1wiO1xuaW1wb3J0IHsgc2hvd01lc3NhZ2UsIHNob3dHYW1lT3ZlciB9IGZyb20gXCIuL2RvbVwiO1xuaW1wb3J0IHsgZ2V0UmFuZG9tQ29vcmRpbmF0ZXMsIGNyZWF0ZUNvbXB1dGVyQ29vcmRpbmF0ZXMgfSBmcm9tICcuL2NvbXB1dGVyY29vcmRpbmF0ZXMnXG5pbXBvcnQgeyBnZXRQb3NpdGlvbnMsIGNyZWF0ZVNoaXBzIH0gZnJvbSAnLi9kcmFnYW5kZHJvcCdcblxubGV0IHBsYXllck9uZSA9IHBsYXllckZhY3RvcnkoXCJwbGF5ZXJPbmVcIiwgXCJwZXJzb25cIik7XG5sZXQgZ2FtZVN0YXR1cyA9IFwiXCI7XG5sZXQgbGFzdENvbXB1dGVyTW92ZSA9ICcnXG5cbmJlZ2luQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgbGV0IHBvc2l0aW9ucyA9IGdldFBvc2l0aW9ucygpXG4gIGxldCBzaGlwcyA9IGNyZWF0ZVNoaXBzKHBvc2l0aW9ucy5ib3hJRCwgcG9zaXRpb25zLnNoaXBJRClcbiAgcGxheWVyT25lLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJjYXJyaWVyXCIsIHNoaXBzLnNoaXBPbmUubGVuZ3RoLCBzaGlwcy5zaGlwT25lKTtcbiAgcGxheWVyT25lLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJiYXR0bGVzaGlwXCIsIHNoaXBzLnNoaXBUd28ubGVuZ3RoLCBzaGlwcy5zaGlwVHdvKTtcbiAgcGxheWVyT25lLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJzdWJtYXJpbmVcIiwgc2hpcHMuc2hpcFRocmVlLmxlbmd0aCwgc2hpcHMuc2hpcFRocmVlKTtcbiAgcGxheWVyT25lLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJjcnVpc2VyXCIsIHNoaXBzLnNoaXBGb3VyLmxlbmd0aCwgc2hpcHMuc2hpcEZvdXIpO1xuICBwbGF5ZXJPbmUuZ2FtZUJvYXJkLnBsYWNlU2hpcChcImRlc3Ryb3llclwiLCBzaGlwcy5zaGlwRml2ZS5sZW5ndGgsIHNoaXBzLnNoaXBGaXZlKTtcbn0pXG5cblxubGV0IGNvbXB1dGVyQ29vcmRpbmF0ZXMgPSBjcmVhdGVDb21wdXRlckNvb3JkaW5hdGVzKClcbmxldCBwbGF5ZXJUd28gPSBwbGF5ZXJGYWN0b3J5KFwicGxheWVyVHdvXCIsIFwiQ29tcHV0ZXJcIik7XG5wbGF5ZXJUd28uZ2FtZUJvYXJkLnBsYWNlU2hpcChcImNhcnJpZXJcIiwgNSwgY29tcHV0ZXJDb29yZGluYXRlcy5maXJzdFNoaXBDb29yZGluYXRlcyk7XG5wbGF5ZXJUd28uZ2FtZUJvYXJkLnBsYWNlU2hpcChcImJhdHRsZXNoaXBcIiwgNCwgY29tcHV0ZXJDb29yZGluYXRlcy5zZWNvbmRTaGlwQ29vcmRpbmF0ZXMpO1xucGxheWVyVHdvLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJzdWJtYXJpbmVcIiwgMywgY29tcHV0ZXJDb29yZGluYXRlcy50aGlyZFNoaXBDb29yZGluYXRlcyk7XG5wbGF5ZXJUd28uZ2FtZUJvYXJkLnBsYWNlU2hpcChcImNydWlzZXJcIiwgMywgY29tcHV0ZXJDb29yZGluYXRlcy5mb3VydGhTaGlwQ29vcmRpbmF0ZXMpO1xucGxheWVyVHdvLmdhbWVCb2FyZC5wbGFjZVNoaXAoXCJkZXN0cm95ZXJcIiwgMiwgY29tcHV0ZXJDb29yZGluYXRlcy5maWZ0aFNoaXBDb29yZGluYXRlcyk7XG5cblxuZnVuY3Rpb24gZGlzYWJsZVNlbGZDbGlja3MoY3VycmVudFBsYXllciwgYm9hcmRPbmUsIGJvYXJkVHdvKSB7XG4gIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllck9uZSkge1xuICAgIGJvYXJkT25lLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcbiAgICBib2FyZFR3by5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhdXRvXCI7XG4gIH0gZWxzZSBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJUd28pIHtcbiAgICBib2FyZFR3by5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgYm9hcmRPbmUuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiYXV0b1wiO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdhbWVPdmVyKG9wcG9zaW5nUGxheWVyKSB7XG4gIGxldCByZXBvcnQgPSBvcHBvc2luZ1BsYXllci5nYW1lQm9hcmQucmVwb3J0KCk7XG4gIGlmIChyZXBvcnQgPT0gXCJBbGwgc2hpcHMgaGF2ZSBzdW5rIVwiKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrR2FtZVN0YXR1cyhnYW1lU3RhdHVzKSB7XG4gIHJldHVybiBnYW1lU3RhdHVzO1xufVxuXG5cbmZ1bmN0aW9uIHBsYXlHYW1lSGVscGVyKGN1cnJlbnRQbGF5ZXIsIG9wcG9zaW5nUGxheWVyLCB0aWxlLCBzcXVhcmUpIHtcbiAgbGV0IGF0dGFjayA9IGN1cnJlbnRQbGF5ZXIuc2VuZEF0dGFjayhvcHBvc2luZ1BsYXllci5nYW1lQm9hcmQsIHNxdWFyZSk7XG4gIGlmIChhdHRhY2sgPT0gXCJub3R2YWxpZFwiKSB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT0gcGxheWVyT25lKSB7XG4gICAgc2hvd01lc3NhZ2UoXCJUaGF0IG1vdmUgaXMgbm90IHZhbGlkLiBQbGVhc2UgcGljayBhbm90aGVyIHRpbGUuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gXCJub3R2YWxpZFwiO1xuICB9XG4gIGlmIChhdHRhY2suYXR0YWNrU3RhdHVzID09IHRydWUpIHtcbiAgICB0aWxlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JlZW5cIjtcbiAgICBzaG93TWVzc2FnZShcIlwiKTtcbiAgfSBlbHNlIGlmIChhdHRhY2sgPT0gZmFsc2UpIHtcbiAgICB0aWxlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgc2hvd01lc3NhZ2UoXCJcIik7XG4gIH1cbiAgaWYgKGF0dGFjay5zaGlwU3RhdHVzID09IHRydWUpIHtcbiAgICBzaG93TWVzc2FnZShcIkEgc2hpcCBiZWNvbWVzIGZlYXN0IGZvciB0aGUgZmlzaGVzIVwiKTtcbiAgfVxuICBnYW1lU3RhdHVzID0gZ2FtZU92ZXIob3Bwb3NpbmdQbGF5ZXIpO1xuICByZXR1cm4gYXR0YWNrXG59XG5cbmZ1bmN0aW9uIHBsYXlHYW1lKGN1cnJlbnRQbGF5ZXIsIGJvYXJkT25lLCBib2FyZFR3bykge1xuICBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICBsZXQgY29vcmRpbmF0ZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJnYW1lU3F1YXJlXCIpKTtcbiAgY29vcmRpbmF0ZXMuZm9yRWFjaCgodGlsZSkgPT4ge1xuICAgIHRpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzcXVhcmUgPSB0aWxlLmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG4gICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgbGV0IG1vdmUgPSBwbGF5R2FtZUhlbHBlcihjdXJyZW50UGxheWVyLCBwbGF5ZXJUd28sIHRpbGUsIHNxdWFyZSk7XG4gICAgICAgIGlmIChtb3ZlICE9IFwibm90dmFsaWRcIikge1xuICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJUd287XG4gICAgICAgICAgZGlzYWJsZVNlbGZDbGlja3MoY3VycmVudFBsYXllciwgYm9hcmRPbmUsIGJvYXJkVHdvKTtcbiAgICAgICAgICBwbGF5R2FtZShjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVja0dhbWVTdGF0dXMoZ2FtZVN0YXR1cykgPT0gdHJ1ZSkge1xuICAgICAgICAgIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllck9uZSkge1xuICAgICAgICAgICAgc2hvd0dhbWVPdmVyKFwiQ29tcHV0ZXJcIik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNob3dHYW1lT3ZlcihwbGF5ZXJPbmVOYW1lLnRleHRDb250ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllclR3bykge1xuICAgIGlmIChsYXN0Q29tcHV0ZXJNb3ZlICE9ICcnKSB7XG4gICAgICBsZXQgbmVpZ2hib3JTcXVhcmUgPSBsYXN0Q29tcHV0ZXJNb3ZlICsgMVxuICAgICAgbGV0IHRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD1cIiR7bmVpZ2hib3JTcXVhcmV9XCJdYClcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgbGV0IG1vdmUgPSBwbGF5R2FtZUhlbHBlcihjdXJyZW50UGxheWVyLCBwbGF5ZXJPbmUsIHRpbGUsIG5laWdoYm9yU3F1YXJlKVxuICAgICAgd2hpbGUgKG1vdmUgPT0gJ25vdHZhbGlkJykge1xuICAgICAgICBsZXQgcmFuZG9tU3F1YXJlID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgOTkpO1xuICAgICAgICBsZXQgcmFuZG9tVGlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtyYW5kb21TcXVhcmV9XCJdYCk7XG4gICAgICAgIG1vdmUgPSBwbGF5R2FtZUhlbHBlcihcbiAgICAgICAgICBjdXJyZW50UGxheWVyLFxuICAgICAgICAgIHBsYXllck9uZSxcbiAgICAgICAgICByYW5kb21UaWxlLFxuICAgICAgICAgIHJhbmRvbVNxdWFyZSlcbiAgICAgIH1cbiAgICAgIGlmIChtb3ZlICE9IFwibm90dmFsaWRcIikge1xuICAgICAgICBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuICAgICAgICBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICAgICAgICBpZiAobW92ZS5hdHRhY2tTdGF0dXMgPT0gdHJ1ZSAmJiBtb3ZlLnNoaXBTdGF0dXMgPT0gZmFsc2UpIHtcbiAgICAgICAgICBsYXN0Q29tcHV0ZXJNb3ZlID0gbmVpZ2hib3JTcXVhcmVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsYXN0Q29tcHV0ZXJNb3ZlID0gJydcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDcwMCk7XG4gICAgfSBlbHNlIHtcbiAgICBsZXQgcmFuZG9tU3F1YXJlID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgOTkpO1xuICAgIGxldCByYW5kb21UaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtaWQ9XCIke3JhbmRvbVNxdWFyZX1cIl1gKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGxldCBtb3ZlID0gcGxheUdhbWVIZWxwZXIoXG4gICAgICAgIGN1cnJlbnRQbGF5ZXIsXG4gICAgICAgIHBsYXllck9uZSxcbiAgICAgICAgcmFuZG9tVGlsZSxcbiAgICAgICAgcmFuZG9tU3F1YXJlXG4gICAgICApO1xuICAgICAgd2hpbGUgKG1vdmUgPT0gJ25vdHZhbGlkJykge1xuICAgICAgICBsZXQgcmFuZG9tU3F1YXJlID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgOTkpO1xuICAgICAgICBsZXQgcmFuZG9tVGlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtyYW5kb21TcXVhcmV9XCJdYCk7XG4gICAgICAgIG1vdmUgPSBwbGF5R2FtZUhlbHBlcihcbiAgICAgICAgICBjdXJyZW50UGxheWVyLFxuICAgICAgICAgIHBsYXllck9uZSxcbiAgICAgICAgICByYW5kb21UaWxlLFxuICAgICAgICAgIHJhbmRvbVNxdWFyZSlcbiAgICAgIH1cbiAgICAgIGlmIChtb3ZlICE9IFwibm90dmFsaWRcIikge1xuICAgICAgICBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuICAgICAgICBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICAgICAgICBpZiAobW92ZS5hdHRhY2tTdGF0dXMgPT0gdHJ1ZSAmJiBtb3ZlLnNoaXBTdGF0dXMgPT0gZmFsc2UpIHtcbiAgICAgICAgICBsYXN0Q29tcHV0ZXJNb3ZlID0gcmFuZG9tU3F1YXJlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGFzdENvbXB1dGVyTW92ZSA9ICcnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCA3MDApO1xuICB9XG59XG59XG5cbmV4cG9ydCB7XG4gIHBsYXllck9uZSxcbiAgcGxheWVyVHdvLFxuICBwbGF5R2FtZSxcbiAgZ2FtZU92ZXIsXG4gIGNoZWNrR2FtZVN0YXR1cyxcbiAgZ2FtZVN0YXR1cyxcbn07XG4iLCJpbXBvcnQge1xuICBjcmVhdGVHYW1lQm9hcmQsXG4gIHNob3dTZWxlY3Rpb25TY3JlZW4sXG4gIHNob3dTZWxlY3RCb2FyZCxcbiAgc2hvd0dhbWVCb2FyZCxcbiAgYWRkUGxheWVyTmFtZSxcbiAgbmV3R2FtZSxcbn0gZnJvbSBcIi4vZG9tXCI7XG5pbXBvcnQge1xuICBwbGF5ZXJPbmUsXG4gIHBsYXllclR3byxcbiAgcGxheUdhbWUsXG59IGZyb20gXCIuL2dhbWVsb2dpY1wiO1xuaW1wb3J0IHsgYWxsb3dEcmFnLCBjdXJyZW50U2hpcCwgZ2V0Q3VycmVudFNoaXAsIGFsbG93RHJvcCwgY2hlY2tQb3NpdGlvbnMgfSBmcm9tIFwiLi9kcmFnYW5kZHJvcFwiO1xuXG5jb25zdCBib2FyZE9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYm9hcmRPbmVcIik7XG5jb25zdCBib2FyZFR3byA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYm9hcmRUd29cIik7XG5jb25zdCBwcmVwYXJlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXBhcmVCdXR0b24nKVxuY29uc3QgYmVnaW5CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJlZ2luQnV0dG9uXCIpO1xuY29uc3QgcGxheWVyT25lTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyT25lTmFtZVwiKTtcbmNvbnN0IG5ld0dhbWVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5ld0dhbWVCdXR0b25cIik7XG5sZXQgcGxheWVyTmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJOYW1lXCIpO1xubGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG5cbmxldCBwbGF5ZXJOYW1lID0gXCJcIjtcbnBsYXllck5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICBwbGF5ZXJOYW1lID0gcGxheWVyTmFtZUlucHV0LnZhbHVlO1xufSk7XG5cbnByZXBhcmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgc2hvd1NlbGVjdGlvblNjcmVlbigpO1xuICBzaG93U2VsZWN0Qm9hcmQoKTtcbiAgYWxsb3dEcmFnKCk7XG4gIGNvbnN0IHNlbGVjdEJveGVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZHJvcHBhYmxlXCIpKTtcbiAgc2VsZWN0Qm94ZXMuZm9yRWFjaChib3ggPT4ge1xuICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKCl7XG4gICAgICAgIGN1cnJlbnRTaGlwID0gZ2V0Q3VycmVudFNoaXAoY3VycmVudFNoaXApXG4gICAgICAgIGFsbG93RHJvcChzZWxlY3RCb3hlcyk7XG4gICAgfSlcbiAgfSlcbn0pO1xuXG5cbmJlZ2luQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIHNob3dHYW1lQm9hcmQoKTtcbiAgYWRkUGxheWVyTmFtZShwbGF5ZXJPbmVOYW1lLCBwbGF5ZXJOYW1lKTtcbiAgY3JlYXRlR2FtZUJvYXJkKHBsYXllck9uZSwgYm9hcmRPbmUpO1xuICBjcmVhdGVHYW1lQm9hcmQocGxheWVyVHdvLCBib2FyZFR3byk7XG59KVxuXG5iZWdpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBwbGF5R2FtZShjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xufSk7XG5cblxubmV3R2FtZUJ1dHRvbi5vbmNsaWNrID0gbmV3R2FtZTtcbiJdLCJuYW1lcyI6WyJjcmVhdGVHYW1lQm9hcmQiLCJwbGF5ZXIiLCJib2FyZCIsImkiLCJnYW1lQm9hcmQiLCJsZW5ndGgiLCJnYW1lU3F1YXJlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwicGxheWVyTmFtZSIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwibmV3R2FtZSIsImxvY2F0aW9uIiwicmVsb2FkIiwic2hvd01lc3NhZ2UiLCJtZXNzYWdlIiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0Q29udGVudCIsImdhbWVCb2FyZEZhY3RvcnkiLCJtaXNzZWRBdHRhY2tzIiwic3VjY2Vzc2Z1bEF0dGFja3MiLCJzdW5rU2hpcHMiLCJwbGFjZVNoaXAiLCJuYW1lT2ZTaGlwIiwiY29vcmRpbmF0ZXMiLCJuZXdTaGlwIiwid2hlcmVIaXQiLCJoaXQiLCJudW1iZXIiLCJwYXJzZUludCIsImluY2x1ZGVzIiwicHVzaCIsImlzU3VuayIsInN1bmtTdGF0dXMiLCJ0aGlzIiwic2hpcEZhY3RvcnkiLCJmb3JFYWNoIiwiY29vcmRpbmF0ZSIsInJlY2VpdmVBdHRhY2siLCJhdHRhY2tTdGF0dXMiLCJzaGlwU3RhdHVzIiwicmVwb3J0IiwibWFwIiwidGlsZSIsInBsYXllckZhY3RvcnkiLCJwbGF5ZXJUeXBlIiwic2VuZEF0dGFjayIsInVuZGVmaW5lZCIsImdldFJhbmRvbUNvb3JkaW5hdGVzIiwibWluIiwibWF4IiwiTWF0aCIsImNlaWwiLCJmbG9vciIsInJhbmRvbSIsImRyYWdnYWJsZVNoaXBzIiwiQXJyYXkiLCJmcm9tIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImN1cnJlbnRTaGlwIiwiYWN0aXZhdGVEcm9wIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInNob3dIb3ZlckNvbG9yIiwidGFyZ2V0Iiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJyZW1vdmVIb3ZlckNvbG9yIiwiZHJhZyIsImUiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZ2V0QXR0cmlidXRlIiwiaWQiLCJkcm9wIiwiZGF0YSIsImdldERhdGEiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0UG9zaXRpb25zIiwiYm94ZXNXaXRoU2hpcHMiLCJmaWx0ZXIiLCJib3giLCJoYXNDaGlsZE5vZGVzIiwiYm94SUQiLCJzaGlwSUQiLCJmaXJzdENoaWxkIiwiY2hlY2tQb3NpdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwiY3JlYXRlU2hpcENvb3JkaW5hdGVzIiwic2hpcCIsIk51bWJlciIsInBsYXllck9uZSIsImdhbWVTdGF0dXMiLCJsYXN0Q29tcHV0ZXJNb3ZlIiwiYmVnaW5CdXR0b24iLCJwb3NpdGlvbnMiLCJzaGlwcyIsImJveGVzIiwic2hpcE9uZSIsInNoaXBUd28iLCJzaGlwVGhyZWUiLCJzaGlwRm91ciIsInNoaXBGaXZlIiwiY3JlYXRlU2hpcHMiLCJjb21wdXRlckNvb3JkaW5hdGVzIiwiZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiIsInRvU3RyaW5nIiwiZmlyc3RTaGlwQ29vcmRpbmF0ZXMiLCJzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbiIsInNlY29uZFNoaXBDb29yZGluYXRlcyIsInRoaXJkU2hpcEZpcnN0UG9zaXRpb24iLCJ0aGlyZFNoaXBDb29yZGluYXRlcyIsImZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uIiwiZm91cnRoU2hpcENvb3JkaW5hdGVzIiwiZmlmdGhTaGlwRmlyc3RQb3NpdGlvbiIsImZpZnRoU2hpcENvb3JkaW5hdGVzIiwiY3JlYXRlQ29tcHV0ZXJDb29yZGluYXRlcyIsInBsYXllclR3byIsImRpc2FibGVTZWxmQ2xpY2tzIiwiY3VycmVudFBsYXllciIsImJvYXJkT25lIiwiYm9hcmRUd28iLCJwb2ludGVyRXZlbnRzIiwicGxheUdhbWVIZWxwZXIiLCJvcHBvc2luZ1BsYXllciIsInNxdWFyZSIsImF0dGFjayIsImdhbWVPdmVyIiwicGxheUdhbWUiLCJnYW1lT3ZlckNvbnRhaW5lciIsImRpc3BsYXlXaW5uZXJUZXh0IiwiaW5uZXJUZXh0IiwibmV3R2FtZUJ1dHRvbiIsIm9uY2xpY2siLCJzaG93R2FtZU92ZXIiLCJwbGF5ZXJPbmVOYW1lIiwibmVpZ2hib3JTcXVhcmUiLCJzZXRUaW1lb3V0IiwibW92ZSIsInJhbmRvbVNxdWFyZSIsInJhbmRvbVRpbGUiLCJwcmVwYXJlQnV0dG9uIiwicGxheWVyTmFtZUlucHV0IiwidmFsdWUiLCJzZWxlY3RCb2FyZCIsInNob3dTZWxlY3RCb2FyZCIsInNlbGVjdEJveGVzIiwic2xpY2UiLCJjb25jYXQiLCJhbGxvd0Ryb3AiLCJhZGRQbGF5ZXJOYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==