(()=>{"use strict";function e(e,t){for(let n=0;n<e.gameBoard.board.length;n++){let a=document.createElement("div");a.classList.add("gameSquare"),a.classList.add(e.playerName),a.setAttribute("data-id",n),t.appendChild(a)}}function t(){location.reload()}function n(e){document.getElementById("message").textContent=e}const a=()=>{let e=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],t=[],n=[],a=0;return{board:e,sunkShips:a,successfulAttacks:n,missedAttacks:t,placeShip:function(t,n,a){let i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const i=e=>(e=parseInt(e),!!n.includes(e)&&(a.push(e),!0)),r=function(e){return t==a.length?(e=!0,this.sunkStatus=e,e):(e=!1,this.sunkStatus=e,e)};return{nameOfShip:e,length:t,coordinates:n,whereHit:a,sunkStatus:arguments.length>4&&void 0!==arguments[4]&&arguments[4],hit:i,isSunk:r}}(t,n,a);a.forEach((t=>{e[t].push(i)}))},receiveAttack:function(i){if(""!=e[i]){n.push(i);let t=e[i][0].hit(i),r=e[i][0].isSunk();return 1==r&&(a+=1),{attackStatus:t,shipStatus:r}}return t.push(i),!1},report:function(){return e.map((e=>{if(""!=e)return e[0].isSunk(),1==e[0].sunkStatus})).includes(!1)?"There are still alive ships":"All ships have sunk!"}}},i=function(e,t){return{playerName:e,sendAttack:function(e,t){let n="valid";return(e.missedAttacks.includes(t)||null!=e.successfulAttacks&&e.successfulAttacks.includes(t))&&(n="notValid"),"valid"==n?e.receiveAttack(t):"notvalid"},gameBoard:a()}};function r(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const o=Array.from(document.getElementsByClassName("draggable"));let c="";function s(e){e.preventDefault()}function d(e){e.target.style.backgroundColor="aqua"}function l(e){e.target.style.backgroundColor=null}function u(e){e.dataTransfer.setData("text",e.target.getAttribute("id")),c=e.target.id}function m(e){e.preventDefault();let t=e.dataTransfer.getData("text"),n=e.target;l(e),n.appendChild(document.querySelector(`[id="${t}"]`))}function h(){let e=Array.from(document.getElementsByClassName("droppable")).filter((e=>{if(e.hasChildNodes())return e}));return{boxID:e.map((e=>e.getAttribute("set-id"))),shipID:e.map((e=>e.firstChild.id))}}function p(){Array.from(document.getElementsByClassName("droppable")).forEach((e=>{e.addEventListener("drop",(function(){5==h().boxID.length&&document.getElementById("beginButton").classList.remove("hidden")}))}))}function g(e,t){return t=Number(t),"carrier"==e?[t,t+1,t+2,t+3,t+4]:"battleship"==e?[t,t+1,t+2,t+3]:"cruiser"==e||"submarine"==e?[t,t+1,t+2]:"destroyer"==e?[t,t+1]:void 0}let f=i("playerOne"),v="",E="";beginButton.addEventListener("click",(function(){let e=h(),t=function(e,t){return{shipOne:g(t[0],e[0]),shipTwo:g(t[1],e[1]),shipThree:g(t[2],e[2]),shipFour:g(t[3],e[3]),shipFive:g(t[4],e[4])}}(e.boxID,e.shipID);f.gameBoard.placeShip("carrier",t.shipOne.length,t.shipOne),f.gameBoard.placeShip("battleship",t.shipTwo.length,t.shipTwo),f.gameBoard.placeShip("submarine",t.shipThree.length,t.shipThree),f.gameBoard.placeShip("cruiser",t.shipFour.length,t.shipFour),f.gameBoard.placeShip("destroyer",t.shipFive.length,t.shipFive)}));let S=function(){let e=r(0,2).toString()+r(0,5).toString();e=Number(e);let t=[e,e+1,e+2,e+3,e+4],n=r(3,4).toString()+r(0,6).toString();n=Number(n);let a=[n,n+1,n+2,n+3],i=r(7,8).toString()+r(0,7).toString();i=Number(i);let o=[i,i+1,i+2],c="9"+r(0,7).toString();c=Number(c);let s=[c,c+1,c+2],d=r(5,6).toString()+r(0,7).toString();return d=Number(d),{firstShipCoordinates:t,secondShipCoordinates:a,thirdShipCoordinates:o,fourthShipCoordinates:s,fifthShipCoordinates:[d,d+1]}}(),y=i("playerTwo");function B(e,t,n){e==f?(t.style.pointerEvents="none",n.style.pointerEvents="auto"):e==y&&(n.style.pointerEvents="none",t.style.pointerEvents="auto")}function L(e,t,a,i){let r=e.sendAttack(t.gameBoard,i);return"notvalid"==r?(e==f&&n("That move is not valid. Please pick another tile."),"notvalid"):(1==r.attackStatus?(a.style.backgroundColor="green",n("")):0==r&&(a.style.backgroundColor="red",n("")),1==r.shipStatus&&n("A ship becomes feast for the fishes!"),v=function(e){return"All ships have sunk!"==e.gameBoard.report()}(t),r)}function b(e,n,a){if(B(e,n,a),Array.from(document.getElementsByClassName("gameSquare")).forEach((i=>{i.addEventListener("click",(function(){let r=i.getAttribute("data-id");e==f&&("notvalid"!=L(e,y,i,r)&&(B(e=y,n,a),b(e,n,a)),1==v&&function(e){const n=document.getElementById("gameOverContainer");document.getElementById("gameWinnerText").innerText=`The game is over. ${e} has won!`,document.getElementById("mainContainer").classList.add("hidden"),n.classList.remove("hidden"),document.getElementById("startNewGameButton").onclick=t}(e==f?"Computer":playerOneName.textContent))}))})),e==y)if(""!=E){let t=E+1,i=document.querySelector(`[data-id="${t}"]`);setTimeout((()=>{let o=L(e,f,i,t);for(;"notvalid"==o;){let t=r(0,99),n=document.querySelector(`[data-id="${t}"]`);o=L(e,f,n,t)}"notvalid"!=o&&(B(e=f,n,a),E=1==o.attackStatus&&0==o.shipStatus?t:"")}),700)}else{let t=r(0,99),i=document.querySelector(`[data-id="${t}"]`);setTimeout((()=>{let o=L(e,f,i,t);for(;"notvalid"==o;){let t=r(0,99),n=document.querySelector(`[data-id="${t}"]`);o=L(e,f,n,t)}"notvalid"!=o&&(B(e=f,n,a),E=1==o.attackStatus&&0==o.shipStatus?t:"")}),700)}}y.gameBoard.placeShip("carrier",5,S.firstShipCoordinates),y.gameBoard.placeShip("battleship",4,S.secondShipCoordinates),y.gameBoard.placeShip("submarine",3,S.thirdShipCoordinates),y.gameBoard.placeShip("cruiser",3,S.fourthShipCoordinates),y.gameBoard.placeShip("destroyer",2,S.fifthShipCoordinates);const k=document.getElementById("boardOne"),C=document.getElementById("boardTwo"),I=document.getElementById("prepareButton"),A=document.getElementById("beginButton"),N=document.getElementById("playerOneName"),T=document.getElementById("newGameButton");let w=document.getElementById("playerName"),x=f,q="";w.addEventListener("input",(function(){q=w.value})),I.addEventListener("click",(function(){document.getElementById("welcomeScreenContainer").classList.add("hidden"),document.getElementById("selectScreenContainer").classList.remove("hidden"),function(){const e=document.getElementById("selectBoard");for(let t=0;t<100;t++){let n=document.createElement("div");n.classList.add("selectSquare"),n.classList.add("droppable"),n.setAttribute("set-id",t),e.appendChild(n)}}(),o.forEach((e=>{e.addEventListener("dragstart",u)}));const e=Array.from(document.getElementsByClassName("droppable"));e.forEach((t=>{t.addEventListener("dragover",(function(){!function(e){"carrier"==c?e.slice(0,6).concat(e.slice(10,16)).concat(e.slice(20,26)).concat(e.slice(30,36)).concat(e.slice(40,46)).concat(e.slice(50,56)).concat(e.slice(60,66)).concat(e.slice(70,76)).concat(e.slice(80,86)).concat(e.slice(90,96)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"battleship"==c?e.slice(0,7).concat(e.slice(10,17)).concat(e.slice(20,27)).concat(e.slice(30,37)).concat(e.slice(40,47)).concat(e.slice(50,57)).concat(e.slice(60,67)).concat(e.slice(70,77)).concat(e.slice(80,87)).concat(e.slice(90,97)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"cruiser"==c||"submarine"==c?e.slice(0,8).concat(e.slice(10,18)).concat(e.slice(20,28)).concat(e.slice(30,38)).concat(e.slice(40,48)).concat(e.slice(50,58)).concat(e.slice(60,68)).concat(e.slice(70,78)).concat(e.slice(80,88)).concat(e.slice(90,98)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)})):"destroyer"==c&&e.slice(0,9).concat(e.slice(10,19)).concat(e.slice(20,29)).concat(e.slice(30,39)).concat(e.slice(40,49)).concat(e.slice(50,59)).concat(e.slice(60,69)).concat(e.slice(70,79)).concat(e.slice(80,89)).concat(e.slice(90,99)).forEach((e=>{e.addEventListener("dragover",s),e.addEventListener("dragover",d),e.addEventListener("dragleave",l),e.addEventListener("drop",m),e.addEventListener("drop",p)}))}(e)}))}))})),A.addEventListener("click",(function(){document.getElementById("selectScreenContainer").classList.add("hidden"),document.getElementById("mainContainer").classList.remove("hidden"),function(e,t){e.textContent=""!=t?t:"Anonymous Challenger"}(N,q),e(f,k),e(y,C)})),A.addEventListener("click",(function(){b(x,k,C)})),T.onclick=t})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksS0FDN0JDLE9BQU9GLEVBQVlDLE1BQU0sR0FBSSxLQUM3QkMsT0FBT0YsRUFBWUMsTUFBTSxHQUFJLEtBQzdCQyxPQUFPRixFQUFZQyxNQUFNLEdBQUksS0FDN0JDLE9BQU9GLEVBQVlDLE1BQU0sR0FBSSxLQUM3QkMsT0FBT0YsRUFBWUMsTUFBTSxHQUFJLEtBQzdCQyxPQUFPRixFQUFZQyxNQUFNLEdBQUksS0FDN0JDLE9BQU9GLEVBQVlDLE1BQU0sR0FBSSxLQUM3QkMsT0FBT0YsRUFBWUMsTUFBTSxHQUFJLEtBQ2pCL0csU0FBUzZDLElBQ3RCQSxFQUFJTSxpQkFBaUIsV0FBWTNCLEdBQ2pDcUIsRUFBSU0saUJBQWlCLFdBQVl4QixHQUNqQ2tCLEVBQUlNLGlCQUFpQixZQUFhcEIsR0FDbENjLEVBQUlNLGlCQUFpQixPQUFRYixHQUM3Qk8sRUFBSU0saUJBQWlCLE9BQVFELEVBQTdCLEdBR0wsQ0V4R08rRCxDQUFVSCxFQUNiLEdBSEQsR0FLSCxJQUdEbkQsRUFBWVIsaUJBQWlCLFNBQVMsV0xwQk5uRixTQUFTWSxlQUNyQyx5QkFFb0JWLFVBQVVDLElBQUksVUFDZEgsU0FBU1ksZUFBZSxpQkFDaENWLFVBQVVrRixPQUFPLFVBYWpDLFNBQXVCMUYsRUFBUVUsR0FFM0JWLEVBQU9tQixZQURTLElBQWRULEVBQ21CQSxFQUVBLHNCQUV4QixDS0ZDOEksQ0FBY2hCLEVBQWU5SCxHQUM3QlgsRUFBZ0IrRixFQUFXNkIsR0FDM0I1SCxFQUFnQnlILEVBQVdJLEVBQzVCLElBRUQzQixFQUFZUixpQkFBaUIsU0FBUyxXQUNwQzBDLEVBQVNULEVBQWVDLEVBQVVDLEVBQ25DLElBR0RtQixFQUFjVCxRQUFVekgsQyIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yeUZ1bmN0aW9ucy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2NvbXB1dGVyY29vcmRpbmF0ZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kcmFnYW5kZHJvcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVsb2dpYy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHNob3dTZWxlY3Rpb25TY3JlZW4oKSB7XG4gIGNvbnN0IHdlbGNvbWVTY3JlZW5Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICBcIndlbGNvbWVTY3JlZW5Db250YWluZXJcIlxuICApO1xuICB3ZWxjb21lU2NyZWVuQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIGNvbnN0IHNlbGVjdFNjcmVlbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgIFwic2VsZWN0U2NyZWVuQ29udGFpbmVyXCJcbiAgKTtcbiAgc2VsZWN0U2NyZWVuQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG59XG5cbmZ1bmN0aW9uIHNob3dTZWxlY3RCb2FyZCgpIHtcbiAgY29uc3Qgc2VsZWN0Qm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlbGVjdEJvYXJkXCIpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7XG4gICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RTcXVhcmVcIik7XG4gICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJkcm9wcGFibGVcIik7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInNldC1pZFwiLCBpKTtcbiAgICBzZWxlY3RCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNob3dHYW1lQm9hcmQoKSB7XG4gIGNvbnN0IHNlbGVjdFNjcmVlbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgIFwic2VsZWN0U2NyZWVuQ29udGFpbmVyXCJcbiAgKTtcbiAgc2VsZWN0U2NyZWVuQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIGNvbnN0IG1haW5Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW5Db250YWluZXJcIik7XG4gIG1haW5Db250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlR2FtZUJvYXJkKHBsYXllciwgYm9hcmQpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5ZXIuZ2FtZUJvYXJkLmJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGdhbWVTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGdhbWVTcXVhcmUuY2xhc3NMaXN0LmFkZChcImdhbWVTcXVhcmVcIik7XG4gICAgZ2FtZVNxdWFyZS5jbGFzc0xpc3QuYWRkKHBsYXllci5wbGF5ZXJOYW1lKTtcbiAgICBnYW1lU3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgaSk7XG4gICAgYm9hcmQuYXBwZW5kQ2hpbGQoZ2FtZVNxdWFyZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYWRkUGxheWVyTmFtZShwbGF5ZXIsIHBsYXllck5hbWUpIHtcbiAgaWYgKHBsYXllck5hbWUgIT0gXCJcIikge1xuICAgIHBsYXllci50ZXh0Q29udGVudCA9IHBsYXllck5hbWU7XG4gIH0gZWxzZSB7XG4gICAgcGxheWVyLnRleHRDb250ZW50ID0gXCJBbm9ueW1vdXMgQ2hhbGxlbmdlclwiO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5ld0dhbWUoKSB7XG4gIGxvY2F0aW9uLnJlbG9hZCgpO1xufVxuXG5mdW5jdGlvbiBzaG93R2FtZU92ZXIoY3VycmVudFBsYXllcikge1xuICBjb25zdCBnYW1lT3ZlckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZU92ZXJDb250YWluZXJcIik7XG4gIGxldCBkaXNwbGF5V2lubmVyVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZVdpbm5lclRleHRcIik7XG4gIGRpc3BsYXlXaW5uZXJUZXh0LmlubmVyVGV4dCA9IGBUaGUgZ2FtZSBpcyBvdmVyLiAke2N1cnJlbnRQbGF5ZXJ9IGhhcyB3b24hYDtcbiAgY29uc3QgbWFpbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpbkNvbnRhaW5lclwiKTtcbiAgbWFpbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICBnYW1lT3ZlckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICBjb25zdCBuZXdHYW1lQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGFydE5ld0dhbWVCdXR0b25cIik7XG4gIG5ld0dhbWVCdXR0b24ub25jbGljayA9IG5ld0dhbWU7XG59XG5cbmZ1bmN0aW9uIHNob3dNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVzc2FnZVwiKTtcbiAgbWVzc2FnZUNvbnRhaW5lci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG59XG5cbmV4cG9ydCB7XG4gIGNyZWF0ZUdhbWVCb2FyZCxcbiAgc2hvd1NlbGVjdGlvblNjcmVlbixcbiAgc2hvd1NlbGVjdEJvYXJkLFxuICBzaG93R2FtZUJvYXJkLFxuICBhZGRQbGF5ZXJOYW1lLFxuICBuZXdHYW1lLFxuICBzaG93R2FtZU92ZXIsXG4gIHNob3dNZXNzYWdlLFxufTtcbiIsImNvbnN0IHNoaXBGYWN0b3J5ID0gKFxuICBuYW1lT2ZTaGlwLFxuICBsZW5ndGgsXG4gIGNvb3JkaW5hdGVzID0gW10sXG4gIHdoZXJlSGl0ID0gW10sXG4gIHN1bmtTdGF0dXMgPSBmYWxzZVxuKSA9PiB7XG4gIGNvbnN0IGhpdCA9IChudW1iZXIpID0+IHtcbiAgICBudW1iZXIgPSBwYXJzZUludChudW1iZXIpXG4gICBpZiAoY29vcmRpbmF0ZXMuaW5jbHVkZXMobnVtYmVyKSkge1xuICAgICAgICB3aGVyZUhpdC5wdXNoKG51bWJlcik7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9O1xuICBjb25zdCBpc1N1bmsgPSBmdW5jdGlvbiAoc3Vua1N0YXR1cykge1xuICAgIGlmIChsZW5ndGggPT0gd2hlcmVIaXQubGVuZ3RoKSB7XG4gICAgICBzdW5rU3RhdHVzID0gdHJ1ZTtcbiAgICAgIHRoaXMuc3Vua1N0YXR1cyA9IHN1bmtTdGF0dXNcbiAgICAgIHJldHVybiBzdW5rU3RhdHVzO1xuICAgIH0gZWxzZSB7XG4gICAgc3Vua1N0YXR1cyA9IGZhbHNlO1xuICAgIHRoaXMuc3Vua1N0YXR1cyA9IHN1bmtTdGF0dXNcbiAgICByZXR1cm4gc3Vua1N0YXR1cztcbiAgfX07XG4gIHJldHVybiB7IG5hbWVPZlNoaXAsIGxlbmd0aCwgY29vcmRpbmF0ZXMsIHdoZXJlSGl0LCBzdW5rU3RhdHVzLCBoaXQsIGlzU3VuayB9O1xufTtcblxuXG4vL2dhbWVCb2FyZCBpcyAxMHgxMFxuXG5jb25zdCBnYW1lQm9hcmRGYWN0b3J5ID0gKCkgPT4ge1xuICBsZXQgYm9hcmQgPSBbXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sXG4gICAgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW11cbiAgXVxuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdXG4gIGxldCBzdWNjZXNzZnVsQXR0YWNrcyA9IFtdXG4gIGxldCBzdW5rU2hpcHMgPSAwXG4gIGNvbnN0IHBsYWNlU2hpcCA9IGZ1bmN0aW9uIChuYW1lT2ZTaGlwLCBsZW5ndGgsIGNvb3JkaW5hdGVzKSB7XG4gICAgbGV0IG5ld1NoaXAgPSBzaGlwRmFjdG9yeShuYW1lT2ZTaGlwLCBsZW5ndGgsIGNvb3JkaW5hdGVzKTtcbiAgICBjb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkaW5hdGUgPT4ge1xuICAgICAgYm9hcmRbY29vcmRpbmF0ZV0ucHVzaChuZXdTaGlwKVxuICAgIH0pXG4gICAgfVxuICA7XG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSBmdW5jdGlvbihudW1iZXIpIHtcbiAgICBpZiAoYm9hcmRbbnVtYmVyXSAhPSBcIlwiKSB7XG4gICAgICBzdWNjZXNzZnVsQXR0YWNrcy5wdXNoKG51bWJlcik7XG4gICAgICBsZXQgYXR0YWNrU3RhdHVzID0gYm9hcmRbbnVtYmVyXVswXS5oaXQobnVtYmVyKTtcbiAgICAgIGxldCBzaGlwU3RhdHVzID0gYm9hcmRbbnVtYmVyXVswXS5pc1N1bmsoKVxuICAgICAgaWYgKHNoaXBTdGF0dXMgPT0gdHJ1ZSkge1xuICAgICAgICBzdW5rU2hpcHMgKz0gMVxuICAgICAgfVxuICAgICAgcmV0dXJuIHthdHRhY2tTdGF0dXMsIHNoaXBTdGF0dXN9XG4gICAgfSBlbHNlIHsgICAgICBcbiAgICAgIG1pc3NlZEF0dGFja3MucHVzaChudW1iZXIpO1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfSBcbiAgfTtcbiAgY29uc3QgcmVwb3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgbGV0IGNoZWNrU3RhdHVzID0gYm9hcmQubWFwKCh0aWxlKSA9PiB7XG4gICAgICBpZiAodGlsZSAhPSAnJykge1xuICAgICAgICB0aWxlWzBdLmlzU3VuaygpXG4gICAgICBpZiAodGlsZVswXS5zdW5rU3RhdHVzID09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgICBpZiAoY2hlY2tTdGF0dXMuaW5jbHVkZXMoZmFsc2UpKSB7XG4gICAgICByZXR1cm4gXCJUaGVyZSBhcmUgc3RpbGwgYWxpdmUgc2hpcHNcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFwiQWxsIHNoaXBzIGhhdmUgc3VuayFcIjtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHsgYm9hcmQsIHN1bmtTaGlwcywgc3VjY2Vzc2Z1bEF0dGFja3MsIG1pc3NlZEF0dGFja3MsIHBsYWNlU2hpcCwgcmVjZWl2ZUF0dGFjaywgcmVwb3J0IH07XG59O1xuXG4vL3BsYXllciBGYWN0b3J5XG5cblxuY29uc3QgcGxheWVyRmFjdG9yeSA9IGZ1bmN0aW9uKHBsYXllck5hbWUsIHBsYXllclR5cGUpIHtcbiAgY29uc3QgZ2FtZUJvYXJkID0gZ2FtZUJvYXJkRmFjdG9yeSgpOyAgIFxuICAgIGNvbnN0IHNlbmRBdHRhY2sgPSBmdW5jdGlvbihib2FyZCwgY29vcmRpbmF0ZSkge1xuICAgICAgbGV0IGF0dGFja1N0YXR1cyA9ICd2YWxpZCdcbiAgICAgIGlmIChib2FyZC5taXNzZWRBdHRhY2tzLmluY2x1ZGVzKGNvb3JkaW5hdGUpKSB7XG4gICAgICAgICAgYXR0YWNrU3RhdHVzID0gJ25vdFZhbGlkJ1xuICAgICAgICB9IGVsc2UgaWYgKGJvYXJkLnN1Y2Nlc3NmdWxBdHRhY2tzICE9IHVuZGVmaW5lZCAmJiBib2FyZC5zdWNjZXNzZnVsQXR0YWNrcy5pbmNsdWRlcyhjb29yZGluYXRlKSkge1xuICAgICAgICAgIGF0dGFja1N0YXR1cyA9ICdub3RWYWxpZCdcbiAgICAgICB9XG4gICAgICAgaWYgKGF0dGFja1N0YXR1cyA9PSAndmFsaWQnKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGUpXG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ25vdHZhbGlkJ1xuICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtwbGF5ZXJOYW1lLCBzZW5kQXR0YWNrLCBnYW1lQm9hcmR9XG59XG5cbmV4cG9ydCB7IGdhbWVCb2FyZEZhY3RvcnksIHBsYXllckZhY3RvcnksIHNoaXBGYWN0b3J5IH07XG4iLCJmdW5jdGlvbiBnZXRSYW5kb21Db29yZGluYXRlcyhtaW4sIG1heCkge1xuICBtaW4gPSBNYXRoLmNlaWwobWluKTtcbiAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW4pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb21wdXRlckNvb3JkaW5hdGVzKCkge1xuICBsZXQgZmlyc3RTaGlwRmlyc3ROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCAyKS50b1N0cmluZygpO1xuICBsZXQgZmlyc3RTaGlwU2Vjb25kTnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgNSkudG9TdHJpbmcoKTtcbiAgbGV0IGZpcnN0U2hpcEZpcnN0UG9zaXRpb24gPSBmaXJzdFNoaXBGaXJzdE51bWJlciArIGZpcnN0U2hpcFNlY29uZE51bWJlcjtcbiAgZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiA9IE51bWJlcihmaXJzdFNoaXBGaXJzdFBvc2l0aW9uKTtcbiAgbGV0IGZpcnN0U2hpcENvb3JkaW5hdGVzID0gW1xuICAgIGZpcnN0U2hpcEZpcnN0UG9zaXRpb24sXG4gICAgZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiArIDEsXG4gICAgZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiArIDIsXG4gICAgZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiArIDMsXG4gICAgZmlyc3RTaGlwRmlyc3RQb3NpdGlvbiArIDQsXG4gIF07XG4gIGxldCBzZWNvbmRTaGlwRmlyc3ROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygzLCA0KS50b1N0cmluZygpO1xuICBsZXQgc2Vjb25kU2hpcFNlY29uZE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDAsIDYpLnRvU3RyaW5nKCk7XG4gIGxldCBzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbiA9IHNlY29uZFNoaXBGaXJzdE51bWJlciArIHNlY29uZFNoaXBTZWNvbmROdW1iZXI7XG4gIHNlY29uZFNoaXBGaXJzdFBvc2l0aW9uID0gTnVtYmVyKHNlY29uZFNoaXBGaXJzdFBvc2l0aW9uKTtcbiAgbGV0IHNlY29uZFNoaXBDb29yZGluYXRlcyA9IFtcbiAgICBzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbixcbiAgICBzZWNvbmRTaGlwRmlyc3RQb3NpdGlvbiArIDEsXG4gICAgc2Vjb25kU2hpcEZpcnN0UG9zaXRpb24gKyAyLFxuICAgIHNlY29uZFNoaXBGaXJzdFBvc2l0aW9uICsgMyxcbiAgXTtcbiAgbGV0IHRoaXJkU2hpcEZpcnN0TnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoNywgOCkudG9TdHJpbmcoKTtcbiAgbGV0IHRoaXJkU2hpcFNlY29uZE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDAsIDcpLnRvU3RyaW5nKCk7XG4gIGxldCB0aGlyZFNoaXBGaXJzdFBvc2l0aW9uID0gdGhpcmRTaGlwRmlyc3ROdW1iZXIgKyB0aGlyZFNoaXBTZWNvbmROdW1iZXI7XG4gIHRoaXJkU2hpcEZpcnN0UG9zaXRpb24gPSBOdW1iZXIodGhpcmRTaGlwRmlyc3RQb3NpdGlvbik7XG4gIGxldCB0aGlyZFNoaXBDb29yZGluYXRlcyA9IFtcbiAgICB0aGlyZFNoaXBGaXJzdFBvc2l0aW9uLFxuICAgIHRoaXJkU2hpcEZpcnN0UG9zaXRpb24gKyAxLFxuICAgIHRoaXJkU2hpcEZpcnN0UG9zaXRpb24gKyAyLFxuICBdO1xuICBsZXQgZm91cnRoU2hpcEZpcnN0TnVtYmVyID0gXCI5XCI7XG4gIGxldCBmb3VydGhTaGlwU2Vjb25kTnVtYmVyID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgNykudG9TdHJpbmcoKTtcbiAgbGV0IGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uID0gZm91cnRoU2hpcEZpcnN0TnVtYmVyICsgZm91cnRoU2hpcFNlY29uZE51bWJlcjtcbiAgZm91cnRoU2hpcEZpcnN0UG9zaXRpb24gPSBOdW1iZXIoZm91cnRoU2hpcEZpcnN0UG9zaXRpb24pO1xuICBsZXQgZm91cnRoU2hpcENvb3JkaW5hdGVzID0gW1xuICAgIGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uLFxuICAgIGZvdXJ0aFNoaXBGaXJzdFBvc2l0aW9uICsgMSxcbiAgICBmb3VydGhTaGlwRmlyc3RQb3NpdGlvbiArIDIsXG4gIF07XG4gIGxldCBmaWZ0aFNoaXBGaXJzdE51bWJlciA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDUsIDYpLnRvU3RyaW5nKCk7XG4gIGxldCBmaWZ0aFNoaXBTZWNvbmROdW1iZXIgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCA3KS50b1N0cmluZygpO1xuICBsZXQgZmlmdGhTaGlwRmlyc3RQb3NpdGlvbiA9IGZpZnRoU2hpcEZpcnN0TnVtYmVyICsgZmlmdGhTaGlwU2Vjb25kTnVtYmVyO1xuICBmaWZ0aFNoaXBGaXJzdFBvc2l0aW9uID0gTnVtYmVyKGZpZnRoU2hpcEZpcnN0UG9zaXRpb24pO1xuICBsZXQgZmlmdGhTaGlwQ29vcmRpbmF0ZXMgPSBbXG4gICAgZmlmdGhTaGlwRmlyc3RQb3NpdGlvbixcbiAgICBmaWZ0aFNoaXBGaXJzdFBvc2l0aW9uICsgMSxcbiAgXTtcbiAgcmV0dXJuIHtcbiAgICBmaXJzdFNoaXBDb29yZGluYXRlcyxcbiAgICBzZWNvbmRTaGlwQ29vcmRpbmF0ZXMsXG4gICAgdGhpcmRTaGlwQ29vcmRpbmF0ZXMsXG4gICAgZm91cnRoU2hpcENvb3JkaW5hdGVzLFxuICAgIGZpZnRoU2hpcENvb3JkaW5hdGVzLFxuICB9O1xufVxuXG5leHBvcnQgeyBnZXRSYW5kb21Db29yZGluYXRlcywgY3JlYXRlQ29tcHV0ZXJDb29yZGluYXRlcyB9O1xuIiwiY29uc3QgZHJhZ2dhYmxlU2hpcHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkcmFnZ2FibGVcIikpO1xubGV0IGN1cnJlbnRTaGlwID0gXCJcIjtcblxuZnVuY3Rpb24gYWN0aXZhdGVEcm9wKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59XG5cbmZ1bmN0aW9uIHNob3dIb3ZlckNvbG9yKGV2ZW50KSB7XG4gIGV2ZW50LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImFxdWFcIjtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlSG92ZXJDb2xvcihldmVudCkge1xuICBldmVudC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gbnVsbDtcbn1cblxuZnVuY3Rpb24gZHJhZyhlKSB7XG4gIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJ0ZXh0XCIsIGUudGFyZ2V0LmdldEF0dHJpYnV0ZShcImlkXCIpKTtcbiAgY3VycmVudFNoaXAgPSBlLnRhcmdldC5pZDtcbn1cblxuZnVuY3Rpb24gZ2V0Q3VycmVudFNoaXAoY3VycmVudFNoaXApIHtcbiAgcmV0dXJuIGN1cnJlbnRTaGlwO1xufVxuXG5mdW5jdGlvbiBkcm9wKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBsZXQgZGF0YSA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJ0ZXh0XCIpO1xuICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gIHJlbW92ZUhvdmVyQ29sb3IoZSk7XG4gIHRhcmdldC5hcHBlbmRDaGlsZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbaWQ9XCIke2RhdGF9XCJdYCkpO1xufVxuXG5sZXQgYWxsb3dEcmFnID0gZnVuY3Rpb24gKCkge1xuICBkcmFnZ2FibGVTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgc2hpcC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGRyYWcpO1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIGdldFBvc2l0aW9ucygpIHtcbiAgY29uc3Qgc2VsZWN0Qm94ZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkcm9wcGFibGVcIikpO1xuICBsZXQgYm94ZXNXaXRoU2hpcHMgPSBzZWxlY3RCb3hlcy5maWx0ZXIoKGJveCkgPT4ge1xuICAgIGlmIChib3guaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICByZXR1cm4gYm94O1xuICAgIH1cbiAgfSk7XG4gIGxldCBib3hJRCA9IGJveGVzV2l0aFNoaXBzLm1hcCgoYm94KSA9PiBib3guZ2V0QXR0cmlidXRlKFwic2V0LWlkXCIpKTtcbiAgbGV0IHNoaXBJRCA9IGJveGVzV2l0aFNoaXBzLm1hcCgoYm94KSA9PiBib3guZmlyc3RDaGlsZC5pZCk7XG4gIHJldHVybiB7IGJveElELCBzaGlwSUQgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tQb3NpdGlvbnMoKSB7XG4gIGNvbnN0IHNlbGVjdEJveGVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZHJvcHBhYmxlXCIpKTtcbiAgc2VsZWN0Qm94ZXMuZm9yRWFjaCgoYm94KSA9PiB7XG4gICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjaGVjayA9IGdldFBvc2l0aW9ucygpO1xuICAgICAgaWYgKGNoZWNrLmJveElELmxlbmd0aCA9PSA1KSB7XG4gICAgICAgIGNvbnN0IGJlZ2luQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZWdpbkJ1dHRvblwiKTtcbiAgICAgICAgYmVnaW5CdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmxldCBhbGxvd0Ryb3AgPSBmdW5jdGlvbiAoc2VsZWN0Qm94ZXMpIHtcbiAgaWYgKGN1cnJlbnRTaGlwID09IFwiY2FycmllclwiKSB7XG4gICAgbGV0IGFsbG93YWJsZUJveGVzID0gc2VsZWN0Qm94ZXNcbiAgICAgIC5zbGljZSgwLCA2KVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgxMCwgMTYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgyMCwgMjYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgzMCwgMzYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg0MCwgNDYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg1MCwgNTYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg2MCwgNjYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg3MCwgNzYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg4MCwgODYpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg5MCwgOTYpKTtcbiAgICBhbGxvd2FibGVCb3hlcy5mb3JFYWNoKChib3gpID0+IHtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgYWN0aXZhdGVEcm9wKTtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgc2hvd0hvdmVyQ29sb3IpO1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgcmVtb3ZlSG92ZXJDb2xvcik7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZHJvcCk7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgY2hlY2tQb3NpdGlvbnMpO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKGN1cnJlbnRTaGlwID09IFwiYmF0dGxlc2hpcFwiKSB7XG4gICAgbGV0IGFsbG93YWJsZUJveGVzID0gc2VsZWN0Qm94ZXNcbiAgICAgIC5zbGljZSgwLCA3KVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgxMCwgMTcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgyMCwgMjcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSgzMCwgMzcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg0MCwgNDcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg1MCwgNTcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg2MCwgNjcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg3MCwgNzcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg4MCwgODcpKVxuICAgICAgLmNvbmNhdChzZWxlY3RCb3hlcy5zbGljZSg5MCwgOTcpKTtcbiAgICBhbGxvd2FibGVCb3hlcy5mb3JFYWNoKChib3gpID0+IHtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgYWN0aXZhdGVEcm9wKTtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgc2hvd0hvdmVyQ29sb3IpO1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgcmVtb3ZlSG92ZXJDb2xvcik7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZHJvcCk7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgY2hlY2tQb3NpdGlvbnMpO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKGN1cnJlbnRTaGlwID09IFwiY3J1aXNlclwiIHx8IGN1cnJlbnRTaGlwID09IFwic3VibWFyaW5lXCIpIHtcbiAgICBsZXQgYWxsb3dhYmxlQm94ZXMgPSBzZWxlY3RCb3hlc1xuICAgICAgLnNsaWNlKDAsIDgpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDEwLCAxOCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDIwLCAyOCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDMwLCAzOCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDQwLCA0OCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDUwLCA1OCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDYwLCA2OCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDcwLCA3OCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDgwLCA4OCkpXG4gICAgICAuY29uY2F0KHNlbGVjdEJveGVzLnNsaWNlKDkwLCA5OCkpO1xuICAgIGFsbG93YWJsZUJveGVzLmZvckVhY2goKGJveCkgPT4ge1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCBhY3RpdmF0ZURyb3ApO1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCBzaG93SG92ZXJDb2xvcik7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCByZW1vdmVIb3ZlckNvbG9yKTtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBkcm9wKTtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBjaGVja1Bvc2l0aW9ucyk7XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoY3VycmVudFNoaXAgPT0gXCJkZXN0cm95ZXJcIikge1xuICAgIGxldCBhbGxvd2FibGVCb3hlcyA9IHNlbGVjdEJveGVzXG4gICAgICAuc2xpY2UoMCwgOSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMTAsIDE5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMjAsIDI5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoMzAsIDM5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNDAsIDQ5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNTAsIDU5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNjAsIDY5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoNzAsIDc5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoODAsIDg5KSlcbiAgICAgIC5jb25jYXQoc2VsZWN0Qm94ZXMuc2xpY2UoOTAsIDk5KSk7XG4gICAgYWxsb3dhYmxlQm94ZXMuZm9yRWFjaCgoYm94KSA9PiB7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIGFjdGl2YXRlRHJvcCk7XG4gICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIHNob3dIb3ZlckNvbG9yKTtcbiAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2xlYXZlXCIsIHJlbW92ZUhvdmVyQ29sb3IpO1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGRyb3ApO1xuICAgICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGNoZWNrUG9zaXRpb25zKTtcbiAgICB9KTtcbiAgfVxufTtcblxuZnVuY3Rpb24gY3JlYXRlU2hpcENvb3JkaW5hdGVzKHNoaXAsIGJveCkge1xuICBib3ggPSBOdW1iZXIoYm94KTtcbiAgaWYgKHNoaXAgPT0gXCJjYXJyaWVyXCIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbYm94LCBib3ggKyAxLCBib3ggKyAyLCBib3ggKyAzLCBib3ggKyA0XTtcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XG4gIH1cbiAgaWYgKHNoaXAgPT0gXCJiYXR0bGVzaGlwXCIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbYm94LCBib3ggKyAxLCBib3ggKyAyLCBib3ggKyAzXTtcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XG4gIH1cbiAgaWYgKHNoaXAgPT0gXCJjcnVpc2VyXCIgfHwgc2hpcCA9PSBcInN1Ym1hcmluZVwiKSB7XG4gICAgbGV0IGNvb3JkaW5hdGVzID0gW2JveCwgYm94ICsgMSwgYm94ICsgMl07XG4gICAgcmV0dXJuIGNvb3JkaW5hdGVzO1xuICB9XG4gIGlmIChzaGlwID09IFwiZGVzdHJveWVyXCIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSBbYm94LCBib3ggKyAxXTtcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlU2hpcHMoYm94ZXMsIHNoaXBzKSB7XG4gIGxldCBzaGlwT25lID0gY3JlYXRlU2hpcENvb3JkaW5hdGVzKHNoaXBzWzBdLCBib3hlc1swXSk7XG4gIGxldCBzaGlwVHdvID0gY3JlYXRlU2hpcENvb3JkaW5hdGVzKHNoaXBzWzFdLCBib3hlc1sxXSk7XG4gIGxldCBzaGlwVGhyZWUgPSBjcmVhdGVTaGlwQ29vcmRpbmF0ZXMoc2hpcHNbMl0sIGJveGVzWzJdKTtcbiAgbGV0IHNoaXBGb3VyID0gY3JlYXRlU2hpcENvb3JkaW5hdGVzKHNoaXBzWzNdLCBib3hlc1szXSk7XG4gIGxldCBzaGlwRml2ZSA9IGNyZWF0ZVNoaXBDb29yZGluYXRlcyhzaGlwc1s0XSwgYm94ZXNbNF0pO1xuICByZXR1cm4geyBzaGlwT25lLCBzaGlwVHdvLCBzaGlwVGhyZWUsIHNoaXBGb3VyLCBzaGlwRml2ZSB9O1xufVxuXG5leHBvcnQge1xuICBhbGxvd0RyYWcsXG4gIGFsbG93RHJvcCxcbiAgZ2V0UG9zaXRpb25zLFxuICBnZXRDdXJyZW50U2hpcCxcbiAgY3VycmVudFNoaXAsXG4gIGNoZWNrUG9zaXRpb25zLFxuICBjcmVhdGVTaGlwcyxcbn07XG4iLCJpbXBvcnQgeyBwbGF5ZXJGYWN0b3J5IH0gZnJvbSBcIi4vZmFjdG9yeUZ1bmN0aW9uc1wiO1xuaW1wb3J0IHsgc2hvd01lc3NhZ2UsIHNob3dHYW1lT3ZlciB9IGZyb20gXCIuL2RvbVwiO1xuaW1wb3J0IHtcbiAgZ2V0UmFuZG9tQ29vcmRpbmF0ZXMsXG4gIGNyZWF0ZUNvbXB1dGVyQ29vcmRpbmF0ZXMsXG59IGZyb20gXCIuL2NvbXB1dGVyY29vcmRpbmF0ZXNcIjtcbmltcG9ydCB7IGdldFBvc2l0aW9ucywgY3JlYXRlU2hpcHMgfSBmcm9tIFwiLi9kcmFnYW5kZHJvcFwiO1xuXG5sZXQgcGxheWVyT25lID0gcGxheWVyRmFjdG9yeShcInBsYXllck9uZVwiLCBcInBlcnNvblwiKTtcbmxldCBnYW1lU3RhdHVzID0gXCJcIjtcbmxldCBsYXN0Q29tcHV0ZXJNb3ZlID0gXCJcIjtcblxuYmVnaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IHBvc2l0aW9ucyA9IGdldFBvc2l0aW9ucygpO1xuICBsZXQgc2hpcHMgPSBjcmVhdGVTaGlwcyhwb3NpdGlvbnMuYm94SUQsIHBvc2l0aW9ucy5zaGlwSUQpO1xuICBwbGF5ZXJPbmUuZ2FtZUJvYXJkLnBsYWNlU2hpcChcImNhcnJpZXJcIiwgc2hpcHMuc2hpcE9uZS5sZW5ndGgsIHNoaXBzLnNoaXBPbmUpO1xuICBwbGF5ZXJPbmUuZ2FtZUJvYXJkLnBsYWNlU2hpcChcbiAgICBcImJhdHRsZXNoaXBcIixcbiAgICBzaGlwcy5zaGlwVHdvLmxlbmd0aCxcbiAgICBzaGlwcy5zaGlwVHdvXG4gICk7XG4gIHBsYXllck9uZS5nYW1lQm9hcmQucGxhY2VTaGlwKFxuICAgIFwic3VibWFyaW5lXCIsXG4gICAgc2hpcHMuc2hpcFRocmVlLmxlbmd0aCxcbiAgICBzaGlwcy5zaGlwVGhyZWVcbiAgKTtcbiAgcGxheWVyT25lLmdhbWVCb2FyZC5wbGFjZVNoaXAoXG4gICAgXCJjcnVpc2VyXCIsXG4gICAgc2hpcHMuc2hpcEZvdXIubGVuZ3RoLFxuICAgIHNoaXBzLnNoaXBGb3VyXG4gICk7XG4gIHBsYXllck9uZS5nYW1lQm9hcmQucGxhY2VTaGlwKFxuICAgIFwiZGVzdHJveWVyXCIsXG4gICAgc2hpcHMuc2hpcEZpdmUubGVuZ3RoLFxuICAgIHNoaXBzLnNoaXBGaXZlXG4gICk7XG59KTtcblxubGV0IGNvbXB1dGVyQ29vcmRpbmF0ZXMgPSBjcmVhdGVDb21wdXRlckNvb3JkaW5hdGVzKCk7XG5sZXQgcGxheWVyVHdvID0gcGxheWVyRmFjdG9yeShcInBsYXllclR3b1wiLCBcIkNvbXB1dGVyXCIpO1xucGxheWVyVHdvLmdhbWVCb2FyZC5wbGFjZVNoaXAoXG4gIFwiY2FycmllclwiLFxuICA1LFxuICBjb21wdXRlckNvb3JkaW5hdGVzLmZpcnN0U2hpcENvb3JkaW5hdGVzXG4pO1xucGxheWVyVHdvLmdhbWVCb2FyZC5wbGFjZVNoaXAoXG4gIFwiYmF0dGxlc2hpcFwiLFxuICA0LFxuICBjb21wdXRlckNvb3JkaW5hdGVzLnNlY29uZFNoaXBDb29yZGluYXRlc1xuKTtcbnBsYXllclR3by5nYW1lQm9hcmQucGxhY2VTaGlwKFxuICBcInN1Ym1hcmluZVwiLFxuICAzLFxuICBjb21wdXRlckNvb3JkaW5hdGVzLnRoaXJkU2hpcENvb3JkaW5hdGVzXG4pO1xucGxheWVyVHdvLmdhbWVCb2FyZC5wbGFjZVNoaXAoXG4gIFwiY3J1aXNlclwiLFxuICAzLFxuICBjb21wdXRlckNvb3JkaW5hdGVzLmZvdXJ0aFNoaXBDb29yZGluYXRlc1xuKTtcbnBsYXllclR3by5nYW1lQm9hcmQucGxhY2VTaGlwKFxuICBcImRlc3Ryb3llclwiLFxuICAyLFxuICBjb21wdXRlckNvb3JkaW5hdGVzLmZpZnRoU2hpcENvb3JkaW5hdGVzXG4pO1xuXG5mdW5jdGlvbiBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pIHtcbiAgaWYgKGN1cnJlbnRQbGF5ZXIgPT0gcGxheWVyT25lKSB7XG4gICAgYm9hcmRPbmUuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICAgIGJvYXJkVHdvLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImF1dG9cIjtcbiAgfSBlbHNlIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllclR3bykge1xuICAgIGJvYXJkVHdvLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcbiAgICBib2FyZE9uZS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhdXRvXCI7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2FtZU92ZXIob3Bwb3NpbmdQbGF5ZXIpIHtcbiAgbGV0IHJlcG9ydCA9IG9wcG9zaW5nUGxheWVyLmdhbWVCb2FyZC5yZXBvcnQoKTtcbiAgaWYgKHJlcG9ydCA9PSBcIkFsbCBzaGlwcyBoYXZlIHN1bmshXCIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tHYW1lU3RhdHVzKGdhbWVTdGF0dXMpIHtcbiAgcmV0dXJuIGdhbWVTdGF0dXM7XG59XG5cbmZ1bmN0aW9uIHBsYXlHYW1lSGVscGVyKGN1cnJlbnRQbGF5ZXIsIG9wcG9zaW5nUGxheWVyLCB0aWxlLCBzcXVhcmUpIHtcbiAgbGV0IGF0dGFjayA9IGN1cnJlbnRQbGF5ZXIuc2VuZEF0dGFjayhvcHBvc2luZ1BsYXllci5nYW1lQm9hcmQsIHNxdWFyZSk7XG4gIGlmIChhdHRhY2sgPT0gXCJub3R2YWxpZFwiKSB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT0gcGxheWVyT25lKSB7XG4gICAgICBzaG93TWVzc2FnZShcIlRoYXQgbW92ZSBpcyBub3QgdmFsaWQuIFBsZWFzZSBwaWNrIGFub3RoZXIgdGlsZS5cIik7XG4gICAgfVxuICAgIHJldHVybiBcIm5vdHZhbGlkXCI7XG4gIH1cbiAgaWYgKGF0dGFjay5hdHRhY2tTdGF0dXMgPT0gdHJ1ZSkge1xuICAgIHRpbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmVlblwiO1xuICAgIHNob3dNZXNzYWdlKFwiXCIpO1xuICB9IGVsc2UgaWYgKGF0dGFjayA9PSBmYWxzZSkge1xuICAgIHRpbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICBzaG93TWVzc2FnZShcIlwiKTtcbiAgfVxuICBpZiAoYXR0YWNrLnNoaXBTdGF0dXMgPT0gdHJ1ZSkge1xuICAgIHNob3dNZXNzYWdlKFwiQSBzaGlwIGJlY29tZXMgZmVhc3QgZm9yIHRoZSBmaXNoZXMhXCIpO1xuICB9XG4gIGdhbWVTdGF0dXMgPSBnYW1lT3ZlcihvcHBvc2luZ1BsYXllcik7XG4gIHJldHVybiBhdHRhY2s7XG59XG5cbmZ1bmN0aW9uIHBsYXlHYW1lKGN1cnJlbnRQbGF5ZXIsIGJvYXJkT25lLCBib2FyZFR3bykge1xuICBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICBsZXQgY29vcmRpbmF0ZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJnYW1lU3F1YXJlXCIpKTtcbiAgY29vcmRpbmF0ZXMuZm9yRWFjaCgodGlsZSkgPT4ge1xuICAgIHRpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzcXVhcmUgPSB0aWxlLmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG4gICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgbGV0IG1vdmUgPSBwbGF5R2FtZUhlbHBlcihjdXJyZW50UGxheWVyLCBwbGF5ZXJUd28sIHRpbGUsIHNxdWFyZSk7XG4gICAgICAgIGlmIChtb3ZlICE9IFwibm90dmFsaWRcIikge1xuICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJUd287XG4gICAgICAgICAgZGlzYWJsZVNlbGZDbGlja3MoY3VycmVudFBsYXllciwgYm9hcmRPbmUsIGJvYXJkVHdvKTtcbiAgICAgICAgICBwbGF5R2FtZShjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVja0dhbWVTdGF0dXMoZ2FtZVN0YXR1cykgPT0gdHJ1ZSkge1xuICAgICAgICAgIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllck9uZSkge1xuICAgICAgICAgICAgc2hvd0dhbWVPdmVyKFwiQ29tcHV0ZXJcIik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNob3dHYW1lT3ZlcihwbGF5ZXJPbmVOYW1lLnRleHRDb250ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllclR3bykge1xuICAgIGlmIChsYXN0Q29tcHV0ZXJNb3ZlICE9IFwiXCIpIHtcbiAgICAgIGxldCBuZWlnaGJvclNxdWFyZSA9IGxhc3RDb21wdXRlck1vdmUgKyAxO1xuICAgICAgbGV0IHRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD1cIiR7bmVpZ2hib3JTcXVhcmV9XCJdYCk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgbGV0IG1vdmUgPSBwbGF5R2FtZUhlbHBlcihcbiAgICAgICAgICBjdXJyZW50UGxheWVyLFxuICAgICAgICAgIHBsYXllck9uZSxcbiAgICAgICAgICB0aWxlLFxuICAgICAgICAgIG5laWdoYm9yU3F1YXJlXG4gICAgICAgICk7XG4gICAgICAgIHdoaWxlIChtb3ZlID09IFwibm90dmFsaWRcIikge1xuICAgICAgICAgIGxldCByYW5kb21TcXVhcmUgPSBnZXRSYW5kb21Db29yZGluYXRlcygwLCA5OSk7XG4gICAgICAgICAgbGV0IHJhbmRvbVRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgYFtkYXRhLWlkPVwiJHtyYW5kb21TcXVhcmV9XCJdYFxuICAgICAgICAgICk7XG4gICAgICAgICAgbW92ZSA9IHBsYXlHYW1lSGVscGVyKFxuICAgICAgICAgICAgY3VycmVudFBsYXllcixcbiAgICAgICAgICAgIHBsYXllck9uZSxcbiAgICAgICAgICAgIHJhbmRvbVRpbGUsXG4gICAgICAgICAgICByYW5kb21TcXVhcmVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3ZlICE9IFwibm90dmFsaWRcIikge1xuICAgICAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG4gICAgICAgICAgZGlzYWJsZVNlbGZDbGlja3MoY3VycmVudFBsYXllciwgYm9hcmRPbmUsIGJvYXJkVHdvKTtcbiAgICAgICAgICBpZiAobW92ZS5hdHRhY2tTdGF0dXMgPT0gdHJ1ZSAmJiBtb3ZlLnNoaXBTdGF0dXMgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGxhc3RDb21wdXRlck1vdmUgPSBuZWlnaGJvclNxdWFyZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFzdENvbXB1dGVyTW92ZSA9IFwiXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCA3MDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgcmFuZG9tU3F1YXJlID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoMCwgOTkpO1xuICAgICAgbGV0IHJhbmRvbVRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD1cIiR7cmFuZG9tU3F1YXJlfVwiXWApO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGxldCBtb3ZlID0gcGxheUdhbWVIZWxwZXIoXG4gICAgICAgICAgY3VycmVudFBsYXllcixcbiAgICAgICAgICBwbGF5ZXJPbmUsXG4gICAgICAgICAgcmFuZG9tVGlsZSxcbiAgICAgICAgICByYW5kb21TcXVhcmVcbiAgICAgICAgKTtcbiAgICAgICAgd2hpbGUgKG1vdmUgPT0gXCJub3R2YWxpZFwiKSB7XG4gICAgICAgICAgbGV0IHJhbmRvbVNxdWFyZSA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKDAsIDk5KTtcbiAgICAgICAgICBsZXQgcmFuZG9tVGlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBgW2RhdGEtaWQ9XCIke3JhbmRvbVNxdWFyZX1cIl1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBtb3ZlID0gcGxheUdhbWVIZWxwZXIoXG4gICAgICAgICAgICBjdXJyZW50UGxheWVyLFxuICAgICAgICAgICAgcGxheWVyT25lLFxuICAgICAgICAgICAgcmFuZG9tVGlsZSxcbiAgICAgICAgICAgIHJhbmRvbVNxdWFyZVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vdmUgIT0gXCJub3R2YWxpZFwiKSB7XG4gICAgICAgICAgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcbiAgICAgICAgICBkaXNhYmxlU2VsZkNsaWNrcyhjdXJyZW50UGxheWVyLCBib2FyZE9uZSwgYm9hcmRUd28pO1xuICAgICAgICAgIGlmIChtb3ZlLmF0dGFja1N0YXR1cyA9PSB0cnVlICYmIG1vdmUuc2hpcFN0YXR1cyA9PSBmYWxzZSkge1xuICAgICAgICAgICAgbGFzdENvbXB1dGVyTW92ZSA9IHJhbmRvbVNxdWFyZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFzdENvbXB1dGVyTW92ZSA9IFwiXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCA3MDApO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQge1xuICBwbGF5ZXJPbmUsXG4gIHBsYXllclR3byxcbiAgcGxheUdhbWUsXG4gIGdhbWVPdmVyLFxuICBjaGVja0dhbWVTdGF0dXMsXG4gIGdhbWVTdGF0dXMsXG59O1xuIiwiaW1wb3J0IHtcbiAgY3JlYXRlR2FtZUJvYXJkLFxuICBzaG93U2VsZWN0aW9uU2NyZWVuLFxuICBzaG93U2VsZWN0Qm9hcmQsXG4gIHNob3dHYW1lQm9hcmQsXG4gIGFkZFBsYXllck5hbWUsXG4gIG5ld0dhbWUsXG59IGZyb20gXCIuL2RvbVwiO1xuaW1wb3J0IHtcbiAgcGxheWVyT25lLFxuICBwbGF5ZXJUd28sXG4gIHBsYXlHYW1lLFxufSBmcm9tIFwiLi9nYW1lbG9naWNcIjtcbmltcG9ydCB7IGFsbG93RHJhZywgY3VycmVudFNoaXAsIGdldEN1cnJlbnRTaGlwLCBhbGxvd0Ryb3AsIGNoZWNrUG9zaXRpb25zIH0gZnJvbSBcIi4vZHJhZ2FuZGRyb3BcIjtcblxuY29uc3QgYm9hcmRPbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJvYXJkT25lXCIpO1xuY29uc3QgYm9hcmRUd28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJvYXJkVHdvXCIpO1xuY29uc3QgcHJlcGFyZUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVwYXJlQnV0dG9uJylcbmNvbnN0IGJlZ2luQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZWdpbkJ1dHRvblwiKTtcbmNvbnN0IHBsYXllck9uZU5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllck9uZU5hbWVcIik7XG5jb25zdCBuZXdHYW1lQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXdHYW1lQnV0dG9uXCIpO1xubGV0IHBsYXllck5hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyTmFtZVwiKTtcbmxldCBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuXG5sZXQgcGxheWVyTmFtZSA9IFwiXCI7XG5wbGF5ZXJOYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgcGxheWVyTmFtZSA9IHBsYXllck5hbWVJbnB1dC52YWx1ZTtcbn0pO1xuXG5wcmVwYXJlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIHNob3dTZWxlY3Rpb25TY3JlZW4oKTtcbiAgc2hvd1NlbGVjdEJvYXJkKCk7XG4gIGFsbG93RHJhZygpO1xuICBjb25zdCBzZWxlY3RCb3hlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRyb3BwYWJsZVwiKSk7XG4gIHNlbGVjdEJveGVzLmZvckVhY2goYm94ID0+IHtcbiAgICBib3guYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCBmdW5jdGlvbigpe1xuICAgICAgICBjdXJyZW50U2hpcCA9IGdldEN1cnJlbnRTaGlwKGN1cnJlbnRTaGlwKVxuICAgICAgICBhbGxvd0Ryb3Aoc2VsZWN0Qm94ZXMpO1xuICAgIH0pXG4gIH0pXG59KTtcblxuXG5iZWdpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBzaG93R2FtZUJvYXJkKCk7XG4gIGFkZFBsYXllck5hbWUocGxheWVyT25lTmFtZSwgcGxheWVyTmFtZSk7XG4gIGNyZWF0ZUdhbWVCb2FyZChwbGF5ZXJPbmUsIGJvYXJkT25lKTtcbiAgY3JlYXRlR2FtZUJvYXJkKHBsYXllclR3bywgYm9hcmRUd28pO1xufSlcblxuYmVnaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgcGxheUdhbWUoY3VycmVudFBsYXllciwgYm9hcmRPbmUsIGJvYXJkVHdvKTtcbn0pO1xuXG5cbm5ld0dhbWVCdXR0b24ub25jbGljayA9IG5ld0dhbWU7XG4iXSwibmFtZXMiOlsiY3JlYXRlR2FtZUJvYXJkIiwicGxheWVyIiwiYm9hcmQiLCJpIiwiZ2FtZUJvYXJkIiwibGVuZ3RoIiwiZ2FtZVNxdWFyZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInBsYXllck5hbWUiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsIm5ld0dhbWUiLCJsb2NhdGlvbiIsInJlbG9hZCIsInNob3dNZXNzYWdlIiwibWVzc2FnZSIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJnYW1lQm9hcmRGYWN0b3J5IiwibWlzc2VkQXR0YWNrcyIsInN1Y2Nlc3NmdWxBdHRhY2tzIiwic3Vua1NoaXBzIiwicGxhY2VTaGlwIiwibmFtZU9mU2hpcCIsImNvb3JkaW5hdGVzIiwibmV3U2hpcCIsIndoZXJlSGl0IiwiaGl0IiwibnVtYmVyIiwicGFyc2VJbnQiLCJpbmNsdWRlcyIsInB1c2giLCJpc1N1bmsiLCJzdW5rU3RhdHVzIiwidGhpcyIsInNoaXBGYWN0b3J5IiwiZm9yRWFjaCIsImNvb3JkaW5hdGUiLCJyZWNlaXZlQXR0YWNrIiwiYXR0YWNrU3RhdHVzIiwic2hpcFN0YXR1cyIsInJlcG9ydCIsIm1hcCIsInRpbGUiLCJwbGF5ZXJGYWN0b3J5IiwicGxheWVyVHlwZSIsInNlbmRBdHRhY2siLCJ1bmRlZmluZWQiLCJnZXRSYW5kb21Db29yZGluYXRlcyIsIm1pbiIsIm1heCIsIk1hdGgiLCJjZWlsIiwiZmxvb3IiLCJyYW5kb20iLCJkcmFnZ2FibGVTaGlwcyIsIkFycmF5IiwiZnJvbSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJjdXJyZW50U2hpcCIsImFjdGl2YXRlRHJvcCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzaG93SG92ZXJDb2xvciIsInRhcmdldCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwicmVtb3ZlSG92ZXJDb2xvciIsImRyYWciLCJlIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImdldEF0dHJpYnV0ZSIsImlkIiwiZHJvcCIsImRhdGEiLCJnZXREYXRhIiwicXVlcnlTZWxlY3RvciIsImdldFBvc2l0aW9ucyIsImJveGVzV2l0aFNoaXBzIiwiZmlsdGVyIiwiYm94IiwiaGFzQ2hpbGROb2RlcyIsImJveElEIiwic2hpcElEIiwiZmlyc3RDaGlsZCIsImNoZWNrUG9zaXRpb25zIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsImNyZWF0ZVNoaXBDb29yZGluYXRlcyIsInNoaXAiLCJOdW1iZXIiLCJwbGF5ZXJPbmUiLCJnYW1lU3RhdHVzIiwibGFzdENvbXB1dGVyTW92ZSIsImJlZ2luQnV0dG9uIiwicG9zaXRpb25zIiwic2hpcHMiLCJib3hlcyIsInNoaXBPbmUiLCJzaGlwVHdvIiwic2hpcFRocmVlIiwic2hpcEZvdXIiLCJzaGlwRml2ZSIsImNyZWF0ZVNoaXBzIiwiY29tcHV0ZXJDb29yZGluYXRlcyIsImZpcnN0U2hpcEZpcnN0UG9zaXRpb24iLCJ0b1N0cmluZyIsImZpcnN0U2hpcENvb3JkaW5hdGVzIiwic2Vjb25kU2hpcEZpcnN0UG9zaXRpb24iLCJzZWNvbmRTaGlwQ29vcmRpbmF0ZXMiLCJ0aGlyZFNoaXBGaXJzdFBvc2l0aW9uIiwidGhpcmRTaGlwQ29vcmRpbmF0ZXMiLCJmb3VydGhTaGlwRmlyc3RQb3NpdGlvbiIsImZvdXJ0aFNoaXBDb29yZGluYXRlcyIsImZpZnRoU2hpcEZpcnN0UG9zaXRpb24iLCJmaWZ0aFNoaXBDb29yZGluYXRlcyIsImNyZWF0ZUNvbXB1dGVyQ29vcmRpbmF0ZXMiLCJwbGF5ZXJUd28iLCJkaXNhYmxlU2VsZkNsaWNrcyIsImN1cnJlbnRQbGF5ZXIiLCJib2FyZE9uZSIsImJvYXJkVHdvIiwicG9pbnRlckV2ZW50cyIsInBsYXlHYW1lSGVscGVyIiwib3Bwb3NpbmdQbGF5ZXIiLCJzcXVhcmUiLCJhdHRhY2siLCJnYW1lT3ZlciIsInBsYXlHYW1lIiwiZ2FtZU92ZXJDb250YWluZXIiLCJpbm5lclRleHQiLCJvbmNsaWNrIiwic2hvd0dhbWVPdmVyIiwicGxheWVyT25lTmFtZSIsIm5laWdoYm9yU3F1YXJlIiwic2V0VGltZW91dCIsIm1vdmUiLCJyYW5kb21TcXVhcmUiLCJyYW5kb21UaWxlIiwicHJlcGFyZUJ1dHRvbiIsIm5ld0dhbWVCdXR0b24iLCJwbGF5ZXJOYW1lSW5wdXQiLCJ2YWx1ZSIsInNlbGVjdEJvYXJkIiwic2hvd1NlbGVjdEJvYXJkIiwic2VsZWN0Qm94ZXMiLCJzbGljZSIsImNvbmNhdCIsImFsbG93RHJvcCIsImFkZFBsYXllck5hbWUiXSwic291cmNlUm9vdCI6IiJ9